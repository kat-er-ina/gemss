<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>gemss_explorer_noncommercial.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>gemss explorer noncommercial</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/index-DFrkvKWf.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/preload-helper-D2MJg03u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/react-Bj1aDYRI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/compiler-runtime-B3qBwwSJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/badge-DX6CQ6PA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useEventListener-Cb-RVVEn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/button-CZ3Cs4qb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/react-dom-CSu739Rf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/Combination-BAEdC-rz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/menu-items-BMjcEb2j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-DwV58Fb1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/createLucideIcon-BCdY6lG5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/check-Dr3SxUsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/x-ZP5cObgf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/select-BVdzZKAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/tooltip-CMQz28hC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/use-toast-BDYuj3zG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useEvent-BhXAndur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/zod-H_cgTO0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/utils-YqBXNpsM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/Deferred-DxQeE5uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/uuid-DXdzqzcr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/DeferredRequestRegistry-CMf25YiV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/session-BOFn9QrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/config-Q0O7_stz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/requests-B4FYHTZl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useLifecycle-ClI_npeg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useNonce-CS26E0hA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useTheme-DQozhcp1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/createReducer-B3rBsy4P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/paths-BzSgteR-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-DBwNzi3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-ChS0Dc_R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-CtsanegT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-Dcqqg9UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-sMh6mJ2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-Btv5Rh1v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-bBwmhqty.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-CoCQUAeM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-Gqv0jSNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/stex-jWatZkll.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toDate-DETS9bBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/database-zap-k4ePIFAU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cells-DPp5cDaO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/spinner-DA8-7wQv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chevron-right--18M_6o9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dropdown-menu-ldcmQvIV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/kbd-Cm6Ba9qg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/renderShortcut-BckyRbYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/multi-map-DxdLNTBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/alert-BOoN6gJ1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/card-OlSjYhmd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/alert-dialog-BW4srmS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dialog-eb-NieZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dist-CDXJRSCj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/label-E64zk6_7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDebounce-7iEVSqwM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/textarea-CRI7xDBj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/numbers-D7O23mOZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/SSRProvider-BIDQNg9Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/context-BfYAMNLF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useNumberFormatter-Db6Vjve5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/usePress-C__vuri5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/input-DUrq2DiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/links-7AQBmdyV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/popover-CH1FzjxU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/switch-dWLWbbtg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/table-DScsXgJW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/mode-Bn7pdJvO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useAsyncData-BMGLSTg8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/errors-TZBmrJmc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/error-banner-B9ts0mNl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/copy-DHrHayPa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/copy-D-8y6iMN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/plus-B7DF33lD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/refresh-cw-Dx8TEWFP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/trash-2-DDsWrxuJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/triangle-alert-CebQ7XwA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/ai-model-dropdown-Dk2SdB3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/defaultLocale-JieDVWC_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/precisionRound-CU2C3Vxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/defaultLocale-BLne0bXb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/vega-loader.browser-DXARUlxo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/tooltip-DxKBXCGp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/ErrorBoundary-B9Ifj8Jf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useInstallPackage-D4fX0Ee_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/ImperativeModal-BNN1HA7x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cell-link-B9b7J8QK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/datasource-CtyqtITR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/state-D4T75eZb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/MarimoErrorOutput-Lf9P8Fhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/copy-icon-v8ME_JKB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/html-to-image-CIQqSu-S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/focus-C1YokgL7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/LazyAnyLanguageCodeMirror-DgZ8iknE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chunk-5FQGJX7Z-DPlx2kjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/katex-CDLTCvjQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/markdown-renderer-DJy8ww5d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/command-2ElA5IkO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/download-os8QlW6l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useRunCells-D2HBb4DB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/purify.es-DZrAQFIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/RenderHTML-D-of_-s7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useIframeCapabilities-B_pQb20b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/formats-CobRswjh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/en-US-CCVfmA-q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/isValid-DDt9wNjK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/dates-CrvjILe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/maps-D2_Mq1pZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/extends-BiFDv3jB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/emotion-is-prop-valid.esm-C59xfSYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDateFormatter-CqhdUl2n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/table-CfDbAm78.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/JsonOutput-PE5ko4gi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDeleteCell-DdRX94yC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/icons-CCHmxi8d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/process-output-ByfLnk6j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/blob-D-eV0cU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/objectWithoutPropertiesLoose-DfWeGRFv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/esm-Bmu2DhPy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/file-Ch78NKWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/play-GLWQQs7F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/add-cell-with-ai-e_HMl7UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/bot-message-square-B2ThzDUZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chat-display--jAB7huF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/chart-no-axes-column-qvVRjhv1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/square-function-B6mgCeFJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/spec-Ch0xnJY4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/column-preview-CXjSXUhP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/toggle-zVW4FXNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/globals-BgACvYmr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/share-ipf2hrOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/react-resizable-panels.browser.esm-Da3ksQXL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/utilities.esm-MA1QpjVT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/floating-outline-BtdqbkUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useAddCell-CmuX2hOk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/eye-off-AK_9uodG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/readonly-python-code-WjTf6Pdd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/file-video-camera-C3wGzBnE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/types-BRfQN3HL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/refresh-ccw-DN_xCV6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/form-BidPUZUn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/field-CySaBlkz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useBoolean-Ck_unDZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/useDeepCompareMemoize-5OUgerQ3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/types-C1UhS3qM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/prop-types-DaaA-ptl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/es-BYgU_srD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/code-xml-CgN_Yig7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/download-Dg7clfkc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/square-CuJ72M8f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/settings-OBbrbhij.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/bundle.esm-i_UbZC0w.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.8/dist/assets/index-CeUwN_0i.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "gemss_explorer_noncommercial.py",
            "mode": "read",
            "version": "0.19.8",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import sys\nimport os\n\n# Add the parent directory to sys.path so 'gemss' can be imported\ncurrent_dir = os.path.dirname(os.path.abspath(__file__))\nparent_dir = os.path.abspath(os.path.join(current_dir, \"..\"))\nif parent_dir not in sys.path:\n    sys.path.append(parent_dir)", "code_hash": "14741274959d64e5d4c665b799aedc2d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "import marimo as mo\nimport numpy as np\nimport pandas as pd\nimport io\nfrom plotly import io as pio\n\n# GEMSS feature selector\nfrom gemss.feature_selection.inference import BayesianFeatureSelector\n\n# Visualizations\nfrom gemss.utils.visualizations import (\n    show_label_histogram,\n    show_final_alphas,\n    show_features_in_components,\n    get_algorithm_progress_plots,\n    get_final_alphas_plot,\n    get_label_histogram_plot,\n    get_label_piechart,\n    get_features_in_components_plot,\n)\n\n# Postprocessing\nfrom gemss.utils.utils import (\n    get_solution_summary_df,\n    save_feature_lists_json,\n    save_feature_lists_txt,\n    save_selector_history_json,\n    save_constants_json,\n)\nfrom gemss.postprocessing.result_postprocessing import (\n    recover_solutions,\n    get_features_from_solutions,\n    get_unique_features,\n)\nfrom gemss.postprocessing.simple_regressions import (\n    detect_task,\n    solve_any_regression,\n    show_regression_metrics,\n)\nfrom gemss.postprocessing.tabpfn_evaluation import (\n    tabpfn_evaluate,\n)\nfrom gemss.data_handling.data_processing import (\n    preprocess_features,\n    get_df_from_X,\n)\n\n# Use default renderer or 'iframe' if plots don't show\n# pio.renderers.default = \"notebook_connected\"", "code_hash": "f91115f622624c53ae2215b9a2dbc39b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "logo_path = os.path.join(current_dir, \"datamole_logo_wide.jpg\")\n\n# Read and display logo\nlogo_link = mo.Html(\n    f\"\"\"\n    \u003Cdiv style=\"text-align: right;\"\u003E\n        \u003Ca href=\"https://www.datamole.ai/\" target=\"_blank\"\u003E\n            {mo.image(src=logo_path, width=1000, alt=\"Datamole\").text}\n        \u003C/a\u003E\n    \u003C/div\u003E\n\"\"\"\n)\n\nmo.image(src=logo_path, width=1000, alt=\"Datamole\")", "code_hash": "9413acc16ff162602b5a3cc54ba2e111", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(r\"\"\"\n# \ud83d\udc8e **GEMSS Explorer** [non-commercial]\n\nThis app helps you discover **multiple distinct feature sets** that explain your data using GEMSS: Gaussian Ensemble for Multiple Sparse Solutions.\n\"\"\")", "code_hash": "bb526f317341d2e31778b047418735bb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "# More details\nintro_help = mo.accordion(\n    {\n        \" \ud83d\udcd6 Read more\": mo.md(\n            \"\"\"\n            ### What you will get\n\n            Instead of finding just one \"best\" set of features, GEMSS discovers **several most likely feature combinations** that predict your target variable comparably well. This is valuable when:\n\n            - You have precious few samples and many more features (common e.g. in life sciences).\n            - Multiple underlying mechanisms might explain your data.\n            - You are striving for an interpretable model.\n            - You want to engineer a multitude of nonlinear and combined features from your original set for exploratory purposes.\n            - Your features are correlated.\n            - When there is domain knowledge to be mined (a human in the loop).\n\n            **Example:** Instead of \"use features A, B, C\", you might discover three solutions: {A, B, C}, {D, E, F}, {A, E, G} \u2014 each explaining the data through a different mechanism.\n\n            ### General workflow overview\n\n            **I. Data loading** - Upload and configure your dataset. \u003Cbr\u003E\n            **II. Algorithm setup** - Configure hyperparameters of GEMSS feature selector. \u003Cbr\u003E\n            **III. Feature selection** - Run Bayesian inference to discover multiple components that describe your data. \u003Cbr\u003E\n            **IV. Solution recovery** - Extract one sparse solution from each component, obtaining an ensemble of feature sets. \u003Cbr\u003E\n            **V. Model evaluation** - Validate each solution by a simple linear/logistic regression model and then a full predictive model.\n\n            Each step builds on the previous one, so please follow the workflow in order.\n\n            Model evaluation requires agreement with the [license of TabPFN](https://huggingface.co/Prior-Labs/tabpfn_2_5#licensing) modeling tool.\n            \"\"\"\n        )\n    }\n)\n\nmo.vstack(\n    [\n        intro_help,\n        mo.md(\"\u003Cbr\u003E\"),\n    ]\n)", "code_hash": "049664b2a8bbc80775a4c03ca4cbee78", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(r\"\"\"\n## **1. Set up input and output**\n\"\"\")", "code_hash": "970b23f63addd6d6d4421eb04cd8e7ac", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "# More details\ndata_help = mo.accordion(\n    {\n        \" \ud83d\udcd6 Guide\": mo.md(\n            \"\"\"\n            ### The input data\n            - must be already cleaned and preprocessed,\n            - should have features in columns and samples in rows,\n            - must contain an index column,\n            - must contain a target/label column: binary classification and regression are supported,\n            - can contain missing values,\n            - only numeric features are supported.\n\n            ### Data scaling\n\n            It is highly recommended to scale your data, unless they already have been.\n            - Use the *minmax* scaling to simply squish all features' values to [0, 1] range.\n            - Use the *standard* scaling when you assume the samples are normally distributed. Each feature will then have mean 0 and standard deviation 1.\n\n            ### The outputs\n\n            When saving is enabled, the following files will be created in the specified directory (names can be customized):\n            - `search_history_results.json` - JSON file containing the history of the feature selection process (backup for possible alternative postprocessing)\n            - `search_setup.json` - JSON file containing the configuration of the feature selection process (for experiment tracking)\n            - `feature_lists.txt` - human-readable text file containing the discovered feature sets\n            - `feature_lists.json` - same as above, but in JSON format for easier programmatical handling in further modeling\n            \"\"\"\n        )\n    }\n)\n\nmo.vstack(\n    [\n        data_help,\n    ]\n)", "code_hash": "149180dc1e4f1bc6ff98541e93f377bb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "# Save configuration\ncheckbox_save_results = mo.ui.checkbox(\n    value=True,\n    label=\"Save results\",\n)\nsave_dir_input = mo.ui.text(\n    value=f\"{current_dir}\\\\results\",\n    label=\"Parent directory for saving this experiment\",\n)\n\nsave_experiment_id = mo.ui.number(1, 1000, value=1, step=1, label=\"Experiment ID\")\nsave_history_name = mo.ui.text(\n    value=\"search_history_results\",\n    label=\"History filename (no extension)\",\n)\nsave_setup_name = mo.ui.text(\n    value=\"search_setup\", label=\"Setup filename (no extension)\"\n)\nsave_features_name = mo.ui.text(\n    value=\"all_candidate_solutions\", label=\"Features filename (no extension)\"\n)\n\nmo.vstack(\n    [\n        mo.md(\"### 1.1 Output configuration\"),\n        checkbox_save_results,\n    ]\n)", "code_hash": "b61f0533e46844a14d17771e040b92af", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "# configure saving options, if saving is enabled\nsave_results = checkbox_save_results.value\nif save_results:\n    _display = mo.vstack(\n        [\n            mo.md(\n                f\"*Output files will be saved in: {save_dir_input.value}/experiment_{save_experiment_id.value}*/\"\n            ),\n            mo.accordion(\n                {\n                    \" Edit save location\": mo.vstack(\n                        [\n                            save_dir_input,\n                            save_experiment_id,\n                        ]\n                    )\n                }\n            ),\n            mo.accordion(\n                {\n                    \"Edit file names\": mo.vstack(\n                        [\n                            save_history_name,\n                            save_setup_name,\n                            save_features_name,\n                        ]\n                    )\n                }\n            ),\n        ]\n    )\nelse:\n    _display = None\n\n_display", "code_hash": "3db586c07ed37528b2c4db58e3fa1d06", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "# UI Components for Data Loading\nfile_uploader = mo.ui.file(\n    kind=\"button\", label=\"Upload CSV dataset\", filetypes=[\".csv\"]\n)\n\nmo.vstack(\n    [\n        mo.md(\"### 1.2 Input data\"),\n        file_uploader,\n        mo.md(\"\u003Cbr\u003E\"),\n    ]\n)", "code_hash": "88287ac4057977e8bb8d6a039a38b807", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "# Logic to load data from uploader\nif file_uploader.value:\n    # Load CSV from the uploaded bytes\n    _content = file_uploader.value[0].contents\n    df_raw = pd.read_csv(io.BytesIO(_content))\n\n    # Column selectors based on the uploaded file\n    index_col_selector = mo.ui.dropdown(\n        options=list(df_raw.columns),\n        label=\"Index column\",\n        value=df_raw.columns[0] if not df_raw.empty else None,\n    )\n    label_col_selector = mo.ui.dropdown(\n        options=list(df_raw.columns),\n        label=\"Target/label column\",\n        value=df_raw.columns[-1] if not df_raw.empty else None,\n    )\n    scaling_selector = mo.ui.dropdown(\n        options=[\"standard\", \"minmax\", None],\n        label=\"Scaling to use\",\n        value=\"minmax\",\n    )\n    allowed_missing_percentage_selector = mo.ui.number(\n        0,\n        50,\n        value=10,\n        step=5,\n        label=\"Missing data allowed in a feature [%]\",\n    )\n\n    data_setup_ui = mo.vstack(\n        [\n            mo.md(\"\u003Cbr\u003E\"),\n            mo.md(\n                f\"\u2705 **Data loaded:** `{file_uploader.value[0].name}` ({df_raw.shape[0]} rows, {df_raw.shape[1]} cols)\"\n            ),\n            mo.vstack([index_col_selector, label_col_selector, scaling_selector]),\n        ]\n    )\nelse:\n    df_raw = None\n    index_col_selector = None\n    label_col_selector = None\n    scaling_selector = None\n\n(\n    mo.vstack(\n        [\n            mo.md(\"**Your loaded dataset:**\"),\n            mo.ui.table(df_raw),\n            mo.md(\"\u003Cbr\u003E\"),\n        ]\n    )\n    if df_raw is not None\n    else mo.vstack(\n        [\n            mo.md(\"---\"),\n        ]\n    )\n)", "code_hash": "40b9e8a1ebaaf3b4b5774a42ed1cb042", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "# Stop if data not loaded\nmo.stop(df_raw is None, mo.md(\"*Please upload your dataset to proceed.*\u003Cbr\u003E\u003Chr\u003E\"))\n\n# Data Preprocessing\ntry:\n    _df_proc = df_raw.copy()\n    if index_col_selector.value:\n        _df_proc.set_index(index_col_selector.value, inplace=True)\n\n    _response = _df_proc[label_col_selector.value]\n    # Preprocess\n    X, y, feature_map = preprocess_features(\n        _df_proc,\n        _response,\n        dropna=\"response\",\n        allowed_missing_percentage=allowed_missing_percentage_selector.value,\n        drop_non_numeric_features=True,\n        apply_scaling=scaling_selector.value,\n        verbose=False,\n    )\n    overall_nan_ratio = np.isnan(X).sum() / (X.shape[0] * X.shape[1])\n    df_processed = get_df_from_X(X, feature_map)\n\nexcept Exception as e:\n    mo.stop(True, mo.md(f\"**Error processing data:** {str(e)}\"))\n\nn_samples = df_processed.shape[0]\nn_features = df_processed.shape[1]\n_n_response_values = pd.Series(y).nunique()\n\nmin_samples_allowed = 10\nmin_features_allowed = 10\ntoo_few_samples = n_samples \u003C min_samples_allowed\ntoo_few_features = n_features \u003C min_features_allowed\n\nmo.stop(\n    too_few_samples,\n    mo.md(\n        f\"**Error: too few samples available:** {n_samples} \u003C {min_samples_allowed}. Fix your dataset before proceeding.\"\n    ),\n)\nmo.stop(\n    too_few_features,\n    mo.md(\n        f\"**Error: too few features available:** {n_features} \u003C {min_features_allowed}. Fix your dataset before proceeding.\"\n    ),\n)\n\nmo.vstack(\n    [\n        mo.md(\n            f\"\"\"\n            \u2705 **Data preprocessed:**\n            - no. samples: {n_samples}\n            - no. features: {n_features}\n            - no. unique response values: {_n_response_values}\n            - missing data: {overall_nan_ratio}%\n            \"\"\"\n        ),\n        # show label distribution either as a pie chart or a histogram, depending on the number of unique values\n        (\n            get_label_piechart(y)\n            if _n_response_values \u003C 5\n            else get_label_histogram_plot(y)\n        ),\n        mo.md(\"---\"),\n        mo.md(\"\u003Cbr\u003E\"),\n    ]\n)", "code_hash": "5cf190339388f30ebf1a9c37333e7116", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(r\"\"\"\n## **2. The feature selection algorithm**\n\nConfigure parameters of the GEMSS feature selection algorithm.\n\"\"\")", "code_hash": "cc35f0038b31c215ce45dbf205818010", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "# UI for Algorithm Configuration\nmo.stop(df_processed is None, mo.md(\"*Please upload data first.*\"))\n\n# Basic Settings\nn_candidates = mo.ui.number(\n    1, 20, value=8, step=1, label=\"Number of components (candidate solutions)\"\n)\nsparsity_est = mo.ui.number(\n    1,\n    15,\n    value=4,\n    step=1,\n    label=\"Desired sparsity (no. features per component)\",\n)\n\n# Advanced Settings\nadv_iter = mo.ui.number(500, 20000, value=3500, step=250, label=\"Iterations\")\nadv_lr = mo.ui.number(0.0000, 0.1, value=0.002, step=0.0001, label=\"Learning rate\")\nadv_batch = mo.ui.number(\n    8,\n    256,\n    value=16,\n    step=4,\n    label=\"Batch size (no. samples in a minibatch)\",\n)\nadv_jaccard = mo.ui.checkbox(\n    value=True, label=\"Enforce diversity (penalize Jaccard similarity)\"\n)\nadv_lambda = mo.ui.number(0, 20000, value=1000, step=250, label=\"Lambda\")\nadv_var_spike = mo.ui.number(\n    0,\n    10,\n    value=0.1,\n    step=0.005,\n    label=\"Spike distribution variance\",\n)\nadv_var_slab = mo.ui.number(\n    0,\n    1000,\n    value=100,\n    step=10,\n    label=\"Slab distribution variance\",\n)\n\n# Parameter help text\nparameter_help = mo.accordion(\n    {\n        \"\ud83d\udcd6 Parameter guide\": mo.md(\n            \"\"\"\n            ### Basic parameters\n\n            - **Number of components:** How many distinct feature sets to discover. It is recommended to overshoot this number (2-3x), especially in adverse conditions.\n            - **Estimated sparsity:** Expected number of features per solution. This guides the algorithm's search.\n\n            ### Advanced optimization settings\n\n            - **Iterations:** More iterations improve convergence but take longer (typical: 3000-5000). Increase if ELBO hasn't converged or features' mu values are still changing.\n            - **Learning rate:** Controls [SGD optimization](https://en.wikipedia.org/wiki/Stochastic_gradient_descent) step size (typical: 0.001-0.003). Decrease if training is unstable, increase if progress is too slow.\n            - **Batch size:** Number of samples used in one SGD optimization step (typical: 16-64). Increase for datasets with missing data, noise, or class imbalance. Increasing batch size proportionally increases run time. Recommendation: have at least 4 samples of the minority class in one batch.\n            - **Enforce diversity:** Penalizes average similarity ([Jaccard index](https://en.wikipedia.org/wiki/Jaccard_index)) of solutions to promote diverse feature combinations. Enable when you want to push more towards distinct explanatory mechanisms.\n            - **Lambda:** Strength of diversity penalty (typical: 0-2000). Higher values \u2192 more different solutions. Increase if solutions overlap too much.\n\n            \u003Ci\u003E**Example batch size setup.**\n            Let your dataset contain 200 samples: 160x class A, 40x class B (i.e. the minority class makes up 20% samples). There is low noise and no missing data.\n            It is desirable to have *at least* 4 samples from each class in a batch (empirical observation) =\u003E batch size = 4 * (1/0.20) = 20 samples.\n            \u003C/i\u003E\n\n            ### Advanced prior settings\n\n            These control how the algorithm balances sparsity (few features) vs. explanatory power (including relevant features).\n\n            This algorithm uses the [Structured Spike-and-Slab](https://en.wikipedia.org/wiki/Spike-and-slab_regression) [prior distribution](https://en.wikipedia.org/wiki/Prior_probability),\n            that is a mixture of two Gaussian distributions.\n            Each feature is assigned to either the wide distribution (Slab) or the steep distribution (Spike).\n\n            - **Spike variance:**\n                - Is the most important parameter for controlling convergence.\n                - Controls sparsity strength (typical: 0.05-0.5).\n                - Increase if all features converge to 0 (over-regularization).\n                - Decrease carefully if too many features are selected (under-regularization).\n\n            - **Slab variance:**\n                - Scale for non-zero features (typical: 50-200).\n                - Adjust together with spike variance to improve feature discrimination.\n            \"\"\"\n        )\n    }\n)\n\nsettings_ui = mo.vstack(\n    [\n        parameter_help,\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.vstack([n_candidates, sparsity_est]),\n        mo.accordion(\n            {\n                \"Advanced optimization settings\": mo.vstack(\n                    [adv_iter, adv_lr, adv_batch, adv_jaccard, adv_lambda]\n                )\n            }\n        ),\n        mo.accordion(\n            {\n                \"Advanced prior settings (Structured Spike-and-Slab)\": mo.vstack(\n                    [adv_var_spike, adv_var_slab]\n                )\n            }\n        ),\n    ]\n)\nsettings_ui", "code_hash": "a79090384e9405bb723b6dd6be6e2905", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.stop(df_processed is None, \"\")\n\n# The big RUN FEATURE SELECTION button\nrun_btn = mo.ui.run_button(label=\"Run feature selection\", kind=\"success\")\n\nmo.vstack(\n    [\n        run_btn,\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.md(\"---\"),\n    ]\n)", "code_hash": "2937f180cba19939d9001d2947c9bc8f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "# Main execution logic\n\n# 1. Stop if data not loaded\nmo.stop(df_raw is None, mo.md(\"*Please upload data first.*\"))\n\n# 2. Stop if button not pressed\nmo.stop(not run_btn.value, mo.md(\"*Ready to run. Click start above.*\"))\n\n# Optimization: class setup\nselector = BayesianFeatureSelector(\n    n_features=X.shape[1],\n    n_components=n_candidates.value,\n    X=X,\n    y=y,\n    prior=\"sss\",\n    sss_sparsity=sparsity_est.value,\n    var_slab=adv_var_slab.value,\n    var_spike=adv_var_spike.value,\n    lr=adv_lr.value,\n    batch_size=adv_batch.value,\n    n_iter=adv_iter.value,\n)\n\n# Run optimizer\nhistory = selector.optimize(\n    regularize=adv_jaccard.value,\n    lambda_jaccard=adv_lambda.value,\n    verbose=True,\n)", "code_hash": "846710931300e09a9aad3d8dbb367234", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "# Saving setup\nif save_results:\n    # Configure saving options, if saving is enabled\n    # Prepare directory\n    experiment_dir = f\"{save_dir_input.value}/experiment_{save_experiment_id.value}\"\n    os.makedirs(experiment_dir, exist_ok=True)\n\n    # Prepare save paths\n    history_path = f\"{experiment_dir}/{save_history_name.value}.json\"\n    setup_path = f\"{experiment_dir}/{save_setup_name.value}.json\"\n    features_path_json = f\"{experiment_dir}/{save_features_name.value}.json\"\n    features_path_txt = f\"{experiment_dir}/{save_features_name.value}.txt\"\n\n    # Define constants that are to be saved\n    constants = {\n        \"N_SAMPLES\": X.shape[0],\n        \"N_FEATURES\": X.shape[1],\n        \"N_CANDIDATE_SOLUTIONS\": n_candidates.value,\n        \"SPARSITY\": sparsity_est.value,\n        \"PRIOR_SPARSITY\": sparsity_est.value,\n        \"PRIOR_TYPE\": \"sss\",\n        \"VAR_SPIKE\": adv_var_spike.value,\n        \"VAR_SLAB\": adv_var_slab.value,\n        \"N_ITER\": adv_iter.value,\n        \"LEARNING_RATE\": adv_lr.value,\n        \"BATCH_SIZE\": adv_batch.value,\n        \"IS_REGULARIZED\": adv_jaccard.value,\n        \"LAMBDA_JACCARD\": adv_lambda.value,\n    }\nelse:\n    experiment_dir = None\n    history_path = None\n    setup_path = None\n    features_path_json = None\n    features_path_txt = None", "code_hash": "e0239550d0eb738a3d0cc79cf1bb0f0f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "# Save history and setup immediately after optimization\nif save_results:\n    # Save history and constants\n    msg_history = save_selector_history_json(history, history_path)\n    msg_constants = save_constants_json(constants, setup_path)\n\n    # Stack output messages\n    _display = mo.vstack(\n        [\n            mo.md(\"\u2705 **Optimization Complete!**\"),\n            mo.md(f\"\ud83d\udcc1 Optimization history saved to: `{experiment_dir}`\"),\n            mo.md(f\"- {msg_history}\"),\n            mo.md(f\"- {msg_constants}\"),\n            mo.md(\"\u003Cbr\u003E\"),\n            mo.md(\"---\"),\n            mo.md(\"\u003Cbr\u003E\"),\n        ]\n    )\nelse:\n    _display = mo.vstack(\n        [\n            mo.md(\"\u2705 **Optimization Complete!**\"),\n            mo.md(\"\u003Cbr\u003E\"),\n            mo.md(\"---\"),\n            mo.md(\"\u003Cbr\u003E\"),\n        ]\n    )\n\n_display", "code_hash": "549c0a85311d8b05ba77c314f8422a55", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.md(r\"\"\"\n## **3. Algorithm progress history**\n\nAssess convergence and features in the components. If needed, adjust the algorithm's parameters and rerun.\n\"\"\")", "code_hash": "23d3d9a0e8c737916e5dd37e6b66611e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "mo.stop(history is None, \"\")  # Show only after feature selector is run\n\n# Visualization of algorithm trajectories\n\n# Get progress plots\nprogress_plots_dict = get_algorithm_progress_plots(\n    history,\n    elbo=True,\n    mu=True,\n    alpha=False,\n    original_feature_names_mapping=feature_map,\n    subsample_history_for_plotting=(\n        True if ((adv_iter.value \u003E 4000) or (n_features \u003E 80)) else False\n    ),\n)\n\nalphas_plots = get_final_alphas_plot(\n    history,\n    show_bar_plot=False,\n    show_pie_chart=True,\n)\nalpha_piechart = alphas_plots[0]\n\n# Elbo convergence help text\nelbo_help = mo.accordion(\n    {\n        \" \ud83d\udcd6 Guide\": mo.md(\n            r\"\"\"\n            The [ELBO (Evidence Lower BOund)](https://en.wikipedia.org/wiki/Evidence_lower_bound) is the objective function that the algorithm maximizes, possibly combined with penalization: $ELBO - \\lambda * penalty$\n\n            The objective function's value should steadily increase and eventually plateau just below zero.\n            Note that oscillations occur naturally due to inherent stochasticity.\n\n            **What to look for:**\n            - **Good convergence:** Steady upward trend that flattens into a plateau. The curve should stabilize before the end of iterations. The final 10-20% of iterations should show minimal change.\n            - **Not converged:** Still increasing steeply at the end \u2192 increase number of iterations.\n            - **Unstable:** Erratic oscillations are not dampened over time \u2192 decrease learning rate or adjust batch size.\n            - **Too high absolute value:** Values in millions or more signify a major problem with the algorithm setup. Assess the features' trajectories below. (Values in low thousands, depending on lambda, are generally favorable.)\n            \"\"\"\n        )\n    }\n)\n\n# Feature convergence help text\nmu_help = mo.accordion(\n    {\n        \" \ud83d\udcd6 Guide\": mo.md(\n            \"\"\"\n            **These plots are crucial for assessment of whether the feature selector produced sensible results.**\n\n            Each plot shows how feature importance values (mu) evolve during optimization for one component.\n            The algorithm assigns each feature to either the Spike (near zero) or Slab (non-zero) distribution.\n\n            **What to look for:**\n            - **Good separation:** Clear gap between features converging to ~0 and features with significant non-zero values.\n            - **Optimization process:** \n\n            **Problem indicators:**\n            - **All features \u2192 0:** Over-regularization. Increase spike variance.\n            - **Features' ordering does not change over time:** May indicate under-regularization.\n            - **Too many non-zero features:** May indicate under-regularization. Carefully decrease spike variance and/or enforce stronger sparsity.\n            - **Oscillating values:** Learning rate too high or batch size too small.\n            - **Set of important features changes multiple times over time** (situation: while most features converge to 0, a few become nonzero. Then the nonzero features become 0 and others emerge. The set of important features significantly changes multiple times.): The algorithm cannot find any significant signal among noise. May indicate fundamental problem with the dataset.\n            \"\"\"\n        )\n    }\n)\n\n# Alpha help text\nalpha_help = mo.accordion(\n    {\n        \" \ud83d\udcd6 Guide\": mo.md(\n            \"\"\"\n            The pie chart shows how the algorithm distributes probability mass across the components.\n            (Alphas represent the mixing weights in the [Gaussian mixture model](https://en.wikipedia.org/wiki/Mixture_model) that approximate the [posterior distribution](https://en.wikipedia.org/wiki/Posterior_probability).)\n\n            The alphas should correspond to the predictive potential of the components.\n\n            **What to look for:**\n            - **(Un)balanced distribution:** If you expect multiple solutions of comparable significance, alphas should be relatively balanced across components. If some components dominate, too many components may have been requested (i.e. the dataset supports fewer distinct solutions).\n            \"\"\"\n        )\n    }\n)\n\nmo.vstack(\n    [\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.md(\"### 3.1 Objective function convergence\"),\n        elbo_help,\n        progress_plots_dict[\"elbo\"].update_layout(\n            height=400, width=200 + adv_iter.value / 8\n        ),\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.md(\"### 3.2 Feature convergence in components\"),\n        mu_help,\n        # Unpack all mu plots\n        *[\n            progress_plots_dict[_plot].update_layout(\n                height=400, width=400 + adv_iter.value / 8\n            )\n            for _plot in progress_plots_dict.keys()\n            if \"mu_\" in _plot\n        ],\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.md(\"### 3.3 Relative importances of components\"),\n        alpha_help,\n        alpha_piechart.update_layout(height=450, width=450),\n        mo.md(\"\u003Cbr\u003E\"),\n    ]\n)", "code_hash": "6e6475e399e221a70816c1d5590eb059", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(r\"\"\"\n## **4. Recover solutions from components**\n\nEach component can be handled in multiple ways to yield feature sets = candidate solutions. Select your strategy.\n\"\"\")", "code_hash": "93bb4e21b02ce245d3b4705daaad6f90", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "mo.stop(history is None, \"\")  # Show only after feature selector is run\n\n# checkboxes to pick solution types\ncheckbox_out20_sol = mo.ui.checkbox(label=\"Outliers with STD \u003E 2.0\", value=True)\ncheckbox_out25_sol = mo.ui.checkbox(label=\"Outliers with STD \u003E 2.5\", value=True)\ncheckbox_out30_sol = mo.ui.checkbox(label=\"Outliers with STD \u003E 3.0\", value=True)\ncheckbox_out35_sol = mo.ui.checkbox(label=\"Outliers with STD \u003E 3.5\", value=False)\ncheckbox_top_sol = mo.ui.checkbox(label=\"Top few features\", value=False)\ncheckbox_full_sol = mo.ui.checkbox(\n    label=\"All features with mu \u003E threshold\", value=False\n)\n\n# advanced settings\ntop_n_features_selector = mo.ui.number(\n    1,\n    df_processed.shape[1],\n    value=sparsity_est.value,\n    label=\"Hard number of top features to be selected ('top' solution type).\",\n)\nmin_mu_selector = mo.ui.number(\n    0,\n    5,\n    value=0.25,\n    label=\"'Zero' threshold for mu values\",\n)\n\n# display options\ncheckbox_summary = mo.ui.checkbox(label=\"Summary\", value=True, disabled=True)\ncheckbox_matrix = mo.ui.checkbox(\n    label=\"Feature distribution across components\", value=True\n)\ncheckbox_regression_l2 = mo.ui.checkbox(\n    label=\"Regression with l2 regularization\", value=True\n)\ncheckbox_regression_l1 = mo.ui.checkbox(\n    label=\"Regression with l1 regularization\", value=False\n)\n\n# description of solution types\nsolution_recovery_help = mo.accordion(\n    {\n        \" \ud83d\udcd6 Guide\": mo.md(\n            \"\"\"\n            ### Solution recovery strategies\n\n            Each component from the feature selector contains information about feature importance (mu values). These can be converted into feature sets (candidate solutions) using different strategies:\n\n            **Outlier-based solutions** (recommended)\n\n            Identifies features with unusually high |mu| values using [statistical outlier detection](https://en.wikipedia.org/wiki/Outlier). Features are selected if their |mu| exceeds:\n            - **STD \u003E 2.0**: Most inclusive (2 standard deviations from mean)\n            - **STD \u003E 2.5**: Moderately selective\n            - **STD \u003E 3.0**: More selective (common choice)\n            - **STD \u003E 3.5**: Most restrictive\n\n            **Top-few solutions**\n\n            Selects a fixed number of top features with highest |mu| values.\n            The number is specified in the advanced settings below.\n\n            **Thresholded solutions**\n\n            Selects all features with |mu| values above an arbitrary threshold (defined in the advanced settings below).\n            This approach is useful for further assessment of importance of the features selected in other strategies \n            because it can order all features in a component based on their |mu| values.\n            For example, if a feature has a significant |mu| value in only one component with generously set threshold, it is likely noise.\n            Important features usually have significant |mu| values in multiple components.\n            \"\"\"\n        )\n    }\n)\n\n# description of solution display options\nsolution_display_help = mo.accordion(\n    {\n        \" \ud83d\udcd6 Guide\": mo.md(\n            \"\"\"\n            For each solution type, you can display:\n\n            **Summary** (always shown): Table listing all features in each component with their mu values, sorted by importance. Helps you understand which features the algorithm selected and their relative importance in the model.\n\n            **Feature distribution across components**: Heatmap/matrix showing which features appear in which components. Useful for:\n            - Identifying features that appear across multiple components (potentially robust predictors)\n            - Checking solution diversity (do different components select different features?)\n            - Understanding feature overlap patterns\n\n            **Regression validation**: Quick assessment of each solution's predictive performance using simple linear/logistic regression:\n            - **L2 regularization** (Ridge): Handles correlated features well, generally more stable\n            - **L1 regularization** (Lasso): Performs additional feature selection, may be more interpretable\n\n            \u26a0\ufe0f **Important:** These regression metrics use the *same data for training and testing* (no cross-validation), so they provide only a preliminary quality check. For rigorous evaluation, create full models.\n\n            The regression results help you quickly identify which solutions show promise before investing time in full model evaluation.\n            \"\"\"\n        )\n    }\n)\n\nmo.vstack(\n    [\n        mo.md(\"### Pick solution types to be recovered from components:\"),\n        solution_recovery_help,\n        mo.vstack(\n            [\n                checkbox_out20_sol,\n                checkbox_out25_sol,\n                checkbox_out30_sol,\n                checkbox_out35_sol,\n                checkbox_top_sol,\n                checkbox_full_sol,\n            ]\n        ),\n        mo.accordion(\n            {\n                \"Advanced setting\": mo.vstack(\n                    [top_n_features_selector, min_mu_selector]\n                )\n            }\n        ),\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.md(\"### Pick what is to be shown:\"),\n        solution_display_help,\n        mo.vstack(\n            [\n                checkbox_summary,\n                checkbox_matrix,\n                checkbox_regression_l2,\n                checkbox_regression_l1,\n            ]\n        ),\n    ]\n)", "code_hash": "fcfea581b5735fb17134508bcde6bc0b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.stop(history is None, \"\")  # Show only after feature selector is run\n\n# The big RUN button\nrecover_btn = mo.ui.run_button(label=\"Recover solutions\", kind=\"success\")\n\nmo.vstack(\n    [\n        mo.md(\"\u003Cbr\u003E\"),\n        recover_btn,\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.md(\"---\"),\n    ]\n)", "code_hash": "6a79219b2b2ba73c2029e5bd2e88fe5b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "mo.stop(history is None, \"\")  # Show only after feature selector is run\n\nmo.stop(\n    not recover_btn.value,\n    mo.md(\"*Ready to recover solutions from components. Click button above.*\"),\n)\nmo.stop(\n    (top_n_features_selector.value is None) or (top_n_features_selector.value \u003C 1),\n    mo.md(\"Please set 'top few features' to value 1 or more.\"),\n)\n\n# Define which outliers are to be recovered\noutlier_deviation_thresholds = []\nif checkbox_out20_sol.value:\n    outlier_deviation_thresholds.append(2.0)\nif checkbox_out25_sol.value:\n    outlier_deviation_thresholds.append(2.5)\nif checkbox_out30_sol.value:\n    outlier_deviation_thresholds.append(3.0)\nif checkbox_out35_sol.value:\n    outlier_deviation_thresholds.append(3.5)\n\n# Recover solutions\nsol_full, sol_top, sol_outliers, _ = recover_solutions(\n    search_history=history,\n    desired_sparsity=top_n_features_selector.value,\n    min_mu_threshold=min_mu_selector.value,\n    original_feature_names_mapping=feature_map,\n    use_median_for_outlier_detection=False,\n    outlier_deviation_thresholds=outlier_deviation_thresholds,\n)\n\n# Put all the requested solution types into a single dictionary\nall_solutions = {}\nfor _key, _outlier in sol_outliers.items():\n    all_solutions[f\"Outlier features ({' = '.join(_key.split(sep='_'))})\"] = (\n        _outlier\n    )\nif checkbox_top_sol.value:\n    all_solutions[\"Top features\"] = sol_top\nif checkbox_full_sol.value:\n    all_solutions[\"Thresholded features\"] = sol_full\n\nmo.stop(\n    all_solutions == {},\n    mo.md(\"Cannot proceed. Please pick a solution type to recover.\"),\n)\n\n# Extract which features are contained in which solution type\n# Get overviews and simple performance metrics\nsolution_summary = (\n    {}\n)  # one dateframe per solution type: feature names with mu values\nall_feature_sets = {}  # features per component, for each solution type\nunique_features_found = (\n    {}\n)  # all unique features across all components of a solution type\nregression_metrics_l1 = {}\nregression_metrics_l2 = {}\n\nfor _type, _solution in all_solutions.items():\n    solution_summary[_type] = get_solution_summary_df(_solution)\n    all_feature_sets[_type] = get_features_from_solutions(_solution)\n    unique_features_found[_type] = get_unique_features(all_feature_sets[_type])\n\n    # Quick validation with simple linear/logistic regression\n    # l2-regularized\n    if checkbox_regression_l2.value and (df_raw is not None):\n        regression_metrics_l2[_type] = solve_any_regression(\n            solutions=all_feature_sets[_type],\n            df=df_raw,  # df_processed,\n            response=y,\n            apply_scaling=scaling_selector.value,\n            penalty=\"l2\",\n            verbose=False,\n        )\n    # l1-regularized\n    if checkbox_regression_l1.value and (df_raw is not None):\n        regression_metrics_l1[_type] = solve_any_regression(\n            solutions=all_feature_sets[_type],\n            df=df_raw,  # df_processed,\n            response=y,\n            apply_scaling=scaling_selector.value,\n            penalty=\"l1\",\n            verbose=False,\n        )\n\nif save_results:\n    # Save candidate solutions\n    msg_features_json = save_feature_lists_json(all_feature_sets, features_path_json)\n    msg_features_txt = save_feature_lists_txt(all_feature_sets, features_path_txt)\n\n    # Stack all the outputs in the correct order\n    _displays = [\n        mo.md(f\"\ud83d\udcc1 **All recovered solutions saved to:** `{experiment_dir}`\"),\n        mo.md(f\"- {msg_features_txt.split('Candidate solutions saved to ')[1]}\"),\n        mo.md(f\"- {msg_features_json.split('Candidate solutions saved to ')[1]}\"),\n        mo.md(\"---\"),\n        mo.md(\"\u003Cbr\u003E\u003Cbr\u003E\"),\n    ]\nelse:\n    _displays = []\n\nfor _type, _solution in all_solutions.items():\n    # Get summary of a solution type\n    _displays.append(mo.md(f\"### Solution type: **{_type}**\"))\n    _displays.append(mo.ui.table(solution_summary[_type]))\n\n    # Get a matrix of features vs. components\n    if checkbox_matrix.value:\n        _displays.append(\n            get_features_in_components_plot(\n                solutions=all_feature_sets[_type],\n                features_to_show=unique_features_found[_type],\n            ).update_layout(showlegend=False),\n        )\n\n    # Regression or classification?\n    task_type = detect_task(y)\n\n    # Get quick validation with a simple regression\n    if checkbox_regression_l2.value or checkbox_regression_l1.value:\n        regression_type = \"logistic\" if task_type == \"classification\" else \"linear\"\n\n    # l2-regularized\n    if checkbox_regression_l2.value:\n        _displays.append(\n            mo.md(\n                f\"#### **Quick l2-regularized {regression_type} regression validation** for {_type} (testing = training data):\"\n            )\n        )\n        _displays.append(mo.ui.table(regression_metrics_l2[_type]))\n\n    # l1-regularized\n    if checkbox_regression_l1.value:\n        _displays.append(\n            mo.md(\n                f\"#### **Quick l1-regularized {regression_type} regression validation** for {_type} (testing = training data):\"\n            )\n        )\n        _displays.append(mo.ui.table(regression_metrics_l1[_type]))\n\n    _displays.append(mo.md(\"\u003Cbr\u003E\u003Cbr\u003E\"))\n    _displays.append(mo.md(\"---\"))\n    _displays.append(mo.md(\"\u003Cbr\u003E\u003Cbr\u003E\"))\n\n# Return all displays stacked vertically\nmo.vstack(_displays)", "code_hash": "c2d0c974ca4e6dc69e25e70e6530bba3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(r\"\"\"\n## **5. Modeling with candidate solutions** [non-commercial use only]\n\nUsing an advanced algorithm to create and evaluate models for each feature set of the chosen solution type. Proper train-test cross-validation is run.\n\n**WARNING:** For downstream modeling, we use TabPFN, whose free licence can be used only for research purposes. [(Read more.)](https://huggingface.co/Prior-Labs/tabpfn_2_5)\n\"\"\")", "code_hash": "6deb25cae9501c2ee5653a920a0e41d4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "# pick one solution type for further evaluation\nmo.stop(\n    all_solutions is None,\n    mo.md(\"*Must recover solutions from components first. Click button above.*\"),\n)\n\nradio_solutions = mo.ui.radio(\n    options=all_solutions.keys(),\n    label=\"Choose one solution type:\",\n)\n\nmo.vstack(\n    [\n        radio_solutions,\n    ]\n)", "code_hash": "4751038f6a33a59d43801b431610de4f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "mo.stop(\n    radio_solutions.value is None,\n    output=mo.md(\"*Cannot proceed to modeling. Pick a solution type.*\"),\n)\n\n# The big RUN button\nmodel_btn = mo.ui.run_button(\n    label=\"Model with TabPFN (non-commercial use only)\", kind=\"success\"\n)\ncheckbox_shap = mo.ui.checkbox(\n    value=False,\n    label=\"Compute feature importances in the model (Shapley values).\",\n)\n\nmo.vstack(\n    [\n        mo.md(\"\u003Cbr\u003E\"),\n        checkbox_shap,\n        model_btn,\n        mo.md(\"\u003Cbr\u003E\"),\n        mo.md(\"---\"),\n    ]\n)", "code_hash": "0aba9ee8261389839ec40aa7b6f3d88b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "mo.stop(\n    not model_btn.value,\n    output=mo.md(\"*Solutions prepared. Press button to start modeling.*\"),\n)\n\n# Get the selected solution type\nselected_solution_type = radio_solutions.value\nselected_solution = all_solutions[selected_solution_type]\n\n_eval_displays = []\n_eval_displays.append(\n    mo.md(\n        f\"\"\"\n        ### Evaluating: **{selected_solution_type}**\n        - Task type: **{task_type}**\n        - Number of components: **{len(selected_solution)}**\n        - Computing SHAP explanations: **{\"Yes\" if checkbox_shap.value else \"No\"}**\n        \"\"\"\n    )\n)\n\n# Get features for each component\ncomponent_features = all_feature_sets[selected_solution_type]\ncomponent_features[\"all_selected_features\"] = unique_features_found[\n    selected_solution_type\n]\n\n# Evaluate each component with TabPFN\ntabpfn_results = {}\nfor component_name, feature_list in component_features.items():\n    # Get the feature subset\n    X_component = df_raw[feature_list]  # df_processed[feature_list]\n\n    # Run TabPFN evaluation\n    tabpfn_results[component_name] = tabpfn_evaluate(\n        X_component,\n        y,\n        apply_scaling=None,  # Already scaled during preprocessing\n        outer_cv_folds=2,\n        tabpfn_kwargs=None,\n        random_state=42,\n        verbose=False,\n        explain=(\n            checkbox_shap.value\n            if component_name != \"all_selected_features\"\n            else False\n        ),\n        shap_sample_size=50,\n    )\n\n# Show average scores (exclude non-scalar values)\nall_scores = pd.DataFrame(\n    {\n        _comp: {\n            k: v\n            for k, v in _result[\"average_scores\"].items()\n            if k not in [\"confusion_matrix_sum\", \"class_distribution\"]\n        }\n        for _comp, _result in tabpfn_results.items()\n    }\n)\n_eval_displays.append(mo.ui.table(all_scores))\n\n# Show Shapley values if computed\nfor _comp, _result in tabpfn_results.items():\n    if \"shap_explanations\" in _result:\n        _eval_displays.append(\n            mo.md(\n                f\"**Shapley values:** feature importances in the model from {_comp}\"\n            )\n        )\n        _eval_displays.append(\n            mo.ui.table(pd.DataFrame(_result[\"shap_explanations\"]))\n        )\n        _eval_displays.append(mo.md(\"\u003Cbr\u003E\"))\n\n# Save results if enabled\nif save_results:\n    scores_path = f\"{experiment_dir}/tabpfn_scores_{selected_solution_type.replace(' ', '_')}.csv\"\n    all_scores.to_csv(scores_path)\n    _eval_displays.append(\n        mo.md(f\"\ud83d\udcca **Results saved to:** `{scores_path.split('/')[-1]}`\u003Cbr\u003E\u003Cbr\u003E\"),\n    )\n\nmo.vstack(_eval_displays)", "code_hash": "0a512875b735e3f5903ac2bb09ae464b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}], "metadata": {"marimo_version": "0.19.8"}, "version": "1"},
            "session": {"cells": [{"code_hash": "14741274959d64e5d4c665b799aedc2d", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f91115f622624c53ae2215b9a2dbc39b", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9413acc16ff162602b5a3cc54ba2e111", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "\u003Cimg src='data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAkACQAAD/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAEAAAAAAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCABYBnIDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKM0ZHqKACiiigAooooAKKKKACijOaKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAozzRSN0oAb0ye1Z2va3a+GtLub6/uoLOytImmnmnlCRwooLM7MeFUAEkk4GKu3EghQsTtGOvvX5k/8FG/2yLL9qjU9R8D6D4gGi/CDwtOh8ZeKYP3g1OdTmPTrMZAlclcjbuDsu4lY4mMnHjMXGhC73PIzfNIYOlzt3fRFj48f8FjfH3xp8fXng/9nTwfday1o5STW3sXu5HXd5fmxwgeXFFuxiSZiCDyqYzXIw/tG/t6/DPGraroF14hs1+c2b6RZXQI64KWe2bAAPfdz615x4L8BfG/9rTwpH4X+Bng/U/AHwftpv8AR5/tA09tWwCPtN7dZD3TsfvJHvjT92oUhA1WbX/gkN+0r8B4JPEvg3xBpNxqXV/+Eb1+aG6nUZyN0kcKuuedpc+mCa+WniMXUk6nvteWi+Xc/NquLzOvL2y9o15aL5LqfUH7Jf8AwXL8M/ELXrXwv8UtJbwJ4iedbR735m09pt20pIGxJbHcQvzhlGCWcAV946PqkGsadFdWs8NxbzRrJHLHIGSRWGQwI4IOevevxY1r9pjwf8f3l8GftO+Eb7wp420/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ooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAqrqd/Fptu808iRwxqWdmOMD6/5NWq+Yf2rP2l5fhZ8bLzwr4g8F+PPGPhPWvB32nTNO8LeH7rUbjV9QF26zwGWEBbdkhWB0aSSNcPIdwKrkBnln/BQv9onxX4t8ONoMVl4j8H+CNYlW0jEEDf8JX48c5L2Wn2ePMtotuPNmnVWAcARsMq/yprXw+0v4YeOfC+meO/B7eNviRJA6/D74D+G5vPj0yFgGN1q05JEYfAklkkJaTbuclA0cX1F8L7P4/fGbwJoWn+FfBA+GniWPTI9M1j4nePVOpapYxFC/wBn02zmIubpot6KZrvyEldHdkd2Yj6C/Y0/YJ8DfsV6DePoaXWu+MddJl8ReLdYk+0az4gnZizPNMckJuPEa4UYBIZss3nSwMKlT2lTWx89PI6dbE/WMS+a2y6Hwz+2d+x58Tm/Y98b/Fn9pb4ia1faf4X0v7Xpnwt+H87aX4dsncRwQ29xIFZ50VpNrkglFDlZSpIr4s/Zevbf9iX9pb9mzXPgJ8XB478Q/FF7VPGnhLTopRbac08kCyWUyZPmKBNMqmUeZG1sJcDKgf0KeMvDek+NvCOoaPrtnZaromq28lpfWl5EssF3A6lXjkRgVZGUkEHgg1+dWrfE/wDYp/4Jf/FXUde+G/gnTdT+IEgnjZ9Dnl1H+z2IbeizXEzQ2oOSjLb/ADKNylMcV01sRSoxvJpHp4jG4bCQvVaS/rY+2/2iP2Ovhx+1Npsdv438LWOrywjbDdjdDdwDLYVJoyrhcsTtztzyQa+NPiF/wQ31X4Xa3L4k+CHxL13wvq8ABhtLyRhu5JZRcQ7TtPGFeNgejHB45hP+Cj37W37Qrvf/AA8+Ekel6DKwa2ll02acspORieVkjk4I5VAPpXQeGv8AgqZ8c/2ZfE1nH+0D8L3s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AooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKZJ1GOtPooA+E/24PhP8cPgv45+LHxK+FMMetSfEK30XTf+JZavd6/psNtFNC8cKEBYrdXk85pIxcTMZXVYoyomXnf2EfB+v8A7Lfws1HQvhH8IPHviT4i+ONQbU/FHjPx7YSeFtLlui+PNlFw8l7JFGJWKRRxyO/7xmcO7tX6HUUAfnNpX7P3xs+Hv7a2v3+gWOoeNvijrnhUafe/FLXrFbDw1oC3lyJZYrO3JZpobWK0tEgtozITLNcPM6CQl/r39kL9kvQ/2RfhtNpGnXuoa9rmt3kmr+I/EOptv1DxDqMpzLczN29FQcIoA5OSfXKKAGoML9KwPHfgHS/iRpcVjq8Ms9mH3vGkrR+YDlSpKENtYEqwBAZGdGyjurdDRQB8x/BP9iHxN4N8Para6v44XQm8R6m+pasvg60/s+5u1wI4LMXcpd4bWCFIooo7VLdkWP77MzszvhP+xFrPw61Hxd/ZGt6N4Bs/FV7G88nhjTxJqr2sJcQxNeXIYFtskjPI8MkxknkZZlGxU+mm6GmYw2e2KAPkn9sb4L+M/B37L1t8JPgH4TaJfEXnW+pajLeqqWFvKS1zPLPO5knurh3bc/7yRt0sjHcVY8l+w7/wR7034Fa9o/in4iaunjXxNokAg0u0KE6XouGZswo/LsGZmDFVAd2fZvw4+4Q/J68d80KMccetcdTBU6lRVJ6tHj1snw9bErFVbya2XRCRLsRQP5YxT3+bgdaAPQ0uC1dT8z1rLZHxF/wUV/ZC8QftT/th/B6GysbMaLp+k619t1TUvDkeuaZZSMLcxJNDKRGWfYwXLAgjI6V57+0j/wAE6fE41f4A+DNE07wdq9npus61d6pfx+AoYtAskltkKPc2MUgiJJQIrM4LMFOSVwf0bdQTnGcUBRJzivaoZ5XpRpxilaCstF/XU8LEcP4es5uW8nfc/KPXf2MfHng79j/9qfwmfBl8/i7xHqek/wBnWPhrQzZeH9TtIJbfyZdPijBAkK+Y06ZJBUHnlq6D9ln4Dap4ZuvGkSeCvENvd6j4N1Oxtnk+Dtj4YxI8XCi8gleVmYAqI8fOW55Ffp7sAGCOKQAKhwOK1lxFWlGUHFau70Xkvlt0OT/VikpKSm9Fbc/Jn/gnH+zfrvw1+Inwzk8QeAvEthfadLEtybv4OWMYtpcEb21cy+eApIbztu7gZFfYf/BRDwl4ltPGXwZ+IGh+Gtb8W2Xw78Tve6rp2jw+ff8A2aa1khaWKPIMhQsCVHJr6hxt4Azg5+lPZdyHgEn9awxGc1K2I+szitOiVvy/M68NkkKOHlh4yetj4A8V6F4z/ag/aT+KHxF03wD410Dw5D8GtQ8F2C65pbWF7q2oyXL3AEFuzGUx7QFBMYy3TIKk8v8AsTfADxv8B/GHwy1f4t+AfEXj+I+H9O07wzrMcLXD/DpxbxK9nLpwUeRjbhrxQznyhuK5wP0mRcAjAHvQFByO1THN5QpulGCtL7/v3J/sOLqKrKb5kfkf8VP+CdHxR8daL+0d4k07wb4Uu73U/G2rSafZ6z4SjuNc1GxlZSbnT76R/k+R2MahPvqxVgxFes/tT/BTx/8AtZD4dfDjQfh9r2r/AAw8D+HILvU08T3svh+bVb2S0a3t4zOYZS01sp8xwEIEjYLcCv0XY7QBxigDC8YxXX/rFWvFyhFuG2lultbWbMP9WaVpRU2ubex+cll4c+Lnjr4R/s7aD4z8H+Jn8V/Cn4pWNjrN5HZTTW93ZW0dxFFqSyhcPAyNHulJ+8pZsBhnM+Fn7Kfxg+CHiX4zfF3wLp2px+Jbj4jeIHu/CepF4bPxvojTiSGSHI+SZTJK0MoBDbivIYg/pcFGMnBpeD2BGKxWdVIy5oxVnuuj1vY0nw9Tmvem79PJ9z8ePE37JPxCX9kr9lLS9S8CeJ2k8JnxK2t2v/CJpr8um+fMWg86xmKxvvyCoZlx95eVFe0fDL9mT+3PgH4T0248K+LrSbTfi1omtmO2+Gtt4akKRbQXlgt5tvkKpkDXLMSm7G3gGv0f8sOMFRgdqQgKO1OtntWpTVPlSSbeiXV39evcihw3Tp1HV57vT8AtV2RBSc1Kp6+1NAyv405Tx9K8T1PpIpLRC0UUUywooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAxRiiigAooooAKKKKACiiigAxRRRQAYxRjFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB//2Q==' alt='Datamole' style='width: 1000px' /\u003E"}, "type": "data"}]}, {"code_hash": "bb526f317341d2e31778b047418735bb", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"gemss-explorer-non-commercial\"\u003E\ud83d\udc8e \u003Cstrong\u003EGEMSS Explorer\u003C/strong\u003E [non-commercial]\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EThis app helps you discover \u003Cstrong\u003Emultiple distinct feature sets\u003C/strong\u003E that explain your data using GEMSS: Gaussian Ensemble for Multiple Sparse Solutions.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "049664b2a8bbc80775a4c03ca4cbee78", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-accordion data-labels='[\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\ud83d\udcd6 Read more\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;]' data-multiple='false'\u003E\u003Cdiv\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"what-you-will-get\"\u003EWhat you will get\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EInstead of finding just one \"best\" set of features, GEMSS discovers \u003Cstrong\u003Eseveral most likely feature combinations\u003C/strong\u003E that predict your target variable comparably well. This is valuable when:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EYou have precious few samples and many more features (common e.g. in life sciences).\u003C/li\u003E\n\u003Cli\u003EMultiple underlying mechanisms might explain your data.\u003C/li\u003E\n\u003Cli\u003EYou are striving for an interpretable model.\u003C/li\u003E\n\u003Cli\u003EYou want to engineer a multitude of nonlinear and combined features from your original set for exploratory purposes.\u003C/li\u003E\n\u003Cli\u003EYour features are correlated.\u003C/li\u003E\n\u003Cli\u003EWhen there is domain knowledge to be mined (a human in the loop).\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EExample:\u003C/strong\u003E Instead of \"use features A, B, C\", you might discover three solutions: {A, B, C}, {D, E, F}, {A, E, G} \u2014 each explaining the data through a different mechanism.\u003C/span\u003E\n\u003Ch3 id=\"general-workflow-overview\"\u003EGeneral workflow overview\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EI. Data loading\u003C/strong\u003E - Upload and configure your dataset. \u003Cbr\u003E\n\u003Cstrong\u003EII. Algorithm setup\u003C/strong\u003E - Configure hyperparameters of GEMSS feature selector. \u003Cbr\u003E\n\u003Cstrong\u003EIII. Feature selection\u003C/strong\u003E - Run Bayesian inference to discover multiple components that describe your data. \u003Cbr\u003E\n\u003Cstrong\u003EIV. Solution recovery\u003C/strong\u003E - Extract one sparse solution from each component, obtaining an ensemble of feature sets. \u003Cbr\u003E\n\u003Cstrong\u003EV. Model evaluation\u003C/strong\u003E - Validate each solution by a simple linear/logistic regression model and then a full predictive model.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EEach step builds on the previous one, so please follow the workflow in order.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EModel evaluation requires agreement with the \u003Ca href=\"https://huggingface.co/Prior-Labs/tabpfn_2_5#licensing\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Elicense of TabPFN\u003C/a\u003E modeling tool.\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E\u003C/marimo-accordion\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cbr\u003E\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "970b23f63addd6d6d4421eb04cd8e7ac", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"1-set-up-input-and-output\"\u003E\u003Cstrong\u003E1. Set up input and output\u003C/strong\u003E\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "149180dc1e4f1bc6ff98541e93f377bb", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-accordion data-labels='[\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\ud83d\udcd6 Guide\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;]' data-multiple='false'\u003E\u003Cdiv\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"the-input-data\"\u003EThe input data\u003C/h3\u003E\n\u003Cul\u003E\n\u003Cli\u003Emust be already cleaned and preprocessed,\u003C/li\u003E\n\u003Cli\u003Eshould have features in columns and samples in rows,\u003C/li\u003E\n\u003Cli\u003Emust contain an index column,\u003C/li\u003E\n\u003Cli\u003Emust contain a target/label column: binary classification and regression are supported,\u003C/li\u003E\n\u003Cli\u003Ecan contain missing values,\u003C/li\u003E\n\u003Cli\u003Eonly numeric features are supported.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch3 id=\"data-scaling\"\u003EData scaling\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EIt is highly recommended to scale your data, unless they already have been.\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EUse the \u003Cem\u003Eminmax\u003C/em\u003E scaling to simply squish all features' values to [0, 1] range.\u003C/li\u003E\n\u003Cli\u003EUse the \u003Cem\u003Estandard\u003C/em\u003E scaling when you assume the samples are normally distributed. Each feature will then have mean 0 and standard deviation 1.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch3 id=\"the-outputs\"\u003EThe outputs\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EWhen saving is enabled, the following files will be created in the specified directory (names can be customized):\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Esearch_history_results.json\u003C/code\u003E - JSON file containing the history of the feature selection process (backup for possible alternative postprocessing)\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003Esearch_setup.json\u003C/code\u003E - JSON file containing the configuration of the feature selection process (for experiment tracking)\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003Efeature_lists.txt\u003C/code\u003E - human-readable text file containing the discovered feature sets\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003Efeature_lists.json\u003C/code\u003E - same as above, but in JSON format for easier programmatical handling in further modeling\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E\u003C/div\u003E\u003C/marimo-accordion\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "b61f0533e46844a14d17771e040b92af", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"11-output-configuration\"\u003E1.1 Output configuration\u003C/h3\u003E\u003C/span\u003E\u003Cmarimo-ui-element object-id='SFPL-0' random-id='e97e2f9d-f3db-aa69-0a52-3aff0d05f89c'\u003E\u003Cmarimo-checkbox data-initial-value='true' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Save results\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-disabled='false'\u003E\u003C/marimo-checkbox\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "3db586c07ed37528b2c4db58e3fa1d06", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cem\u003EOutput files will be saved in: C:\\Users\\Datamole\\gemss\\app\\results/experiment_1\u003C/em\u003E/\u003C/span\u003E\u003C/span\u003E\u003Cmarimo-accordion data-labels='[\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Edit save location\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;]' data-multiple='false'\u003E\u003Cdiv\u003E\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-ui-element object-id='SFPL-1' random-id='c9cbcafd-c536-496d-fb49-adc58fdd7d65'\u003E\u003Cmarimo-text data-initial-value='\u0026quot;C:\u0026#92;\u0026#92;Users\u0026#92;\u0026#92;Datamole\u0026#92;\u0026#92;gemss\u0026#92;\u0026#92;app\u0026#92;\u0026#92;results\u0026quot;' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Parent directory for saving this experiment\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-placeholder='\u0026quot;\u0026quot;' data-kind='\u0026quot;text\u0026quot;' data-full-width='false' data-disabled='false' data-debounce='true'\u003E\u003C/marimo-text\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='SFPL-2' random-id='53f8a118-9a93-b955-5ff8-38c259869745'\u003E\u003Cmarimo-number data-initial-value='1' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Experiment ID\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-start='1' data-stop='1000' data-step='1' data-debounce='false' data-full-width='false' data-disabled='false'\u003E\u003C/marimo-number\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003C/div\u003E\u003C/marimo-accordion\u003E\u003Cmarimo-accordion data-labels='[\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Edit file names\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;]' data-multiple='false'\u003E\u003Cdiv\u003E\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cmarimo-ui-element object-id='SFPL-3' random-id='fcccff6a-7adf-6300-f018-b47e9fe7e3ea'\u003E\u003Cmarimo-text data-initial-value='\u0026quot;search_history_results\u0026quot;' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;History filename (no extension)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-placeholder='\u0026quot;\u0026quot;' data-kind='\u0026quot;text\u0026quot;' data-full-width='false' data-disabled='false' data-debounce='true'\u003E\u003C/marimo-text\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='SFPL-4' random-id='46d3e160-cef4-855b-7043-e42d1cbe7ac9'\u003E\u003Cmarimo-text data-initial-value='\u0026quot;search_setup\u0026quot;' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Setup filename (no extension)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-placeholder='\u0026quot;\u0026quot;' data-kind='\u0026quot;text\u0026quot;' data-full-width='false' data-disabled='false' data-debounce='true'\u003E\u003C/marimo-text\u003E\u003C/marimo-ui-element\u003E\u003Cmarimo-ui-element object-id='SFPL-5' random-id='e633211f-89f3-2dfd-7e54-4f0aba5357cd'\u003E\u003Cmarimo-text data-initial-value='\u0026quot;all_candidate_solutions\u0026quot;' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Features filename (no extension)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-placeholder='\u0026quot;\u0026quot;' data-kind='\u0026quot;text\u0026quot;' data-full-width='false' data-disabled='false' data-debounce='true'\u003E\u003C/marimo-text\u003E\u003C/marimo-ui-element\u003E\u003C/div\u003E\u003C/div\u003E\u003C/marimo-accordion\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "88287ac4057977e8bb8d6a039a38b807", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch3 id=\"12-input-data\"\u003E1.2 Input data\u003C/h3\u003E\u003C/span\u003E\u003Cmarimo-ui-element object-id='RGSE-0' random-id='09daf779-bdcd-d094-5215-6b379112e112'\u003E\u003Cmarimo-file data-initial-value='[]' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;Upload CSV dataset\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-filetypes='[\u0026quot;.csv\u0026quot;]' data-multiple='false' data-kind='\u0026quot;button\u0026quot;' data-max_size='100000000'\u003E\u003C/marimo-file\u003E\u003C/marimo-ui-element\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cbr\u003E\u003C/span\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "40b9e8a1ebaaf3b4b5774a42ed1cb042", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "\u003Cdiv style='display: flex;flex: 1;flex-direction: column;justify-content: flex-start;align-items: normal;flex-wrap: nowrap;gap: 0.5rem'\u003E\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\u003C/span\u003E\u003C/div\u003E"}, "type": "data"}]}, {"code_hash": "5cf190339388f30ebf1a9c37333e7116", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Cem\u003EPlease upload your dataset to proceed.\u003C/em\u003E\u003Cbr\u003E\u003Chr\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "cc35f0038b31c215ce45dbf205818010", "console": [], "id": "Hstk", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"2-the-feature-selection-algorithm\"\u003E\u003Cstrong\u003E2. The feature selection algorithm\u003C/strong\u003E\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EConfigure parameters of the GEMSS feature selection algorithm.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a79090384e9405bb723b6dd6be6e2905", "console": [], "id": "nWHF", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "2937f180cba19939d9001d2947c9bc8f", "console": [], "id": "iLit", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "846710931300e09a9aad3d8dbb367234", "console": [], "id": "ZHCJ", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "e0239550d0eb738a3d0cc79cf1bb0f0f", "console": [], "id": "ROlb", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "549c0a85311d8b05ba77c314f8422a55", "console": [], "id": "qnkX", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "23d3d9a0e8c737916e5dd37e6b66611e", "console": [], "id": "TqIu", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"3-algorithm-progress-history\"\u003E\u003Cstrong\u003E3. Algorithm progress history\u003C/strong\u003E\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EAssess convergence and features in the components. If needed, adjust the algorithm's parameters and rerun.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6e6475e399e221a70816c1d5590eb059", "console": [], "id": "Vxnm", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "93bb4e21b02ce245d3b4705daaad6f90", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"4-recover-solutions-from-components\"\u003E\u003Cstrong\u003E4. Recover solutions from components\u003C/strong\u003E\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EEach component can be handled in multiple ways to yield feature sets = candidate solutions. Select your strategy.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "fcfea581b5735fb17134508bcde6bc0b", "console": [], "id": "ulZA", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "6a79219b2b2ba73c2029e5bd2e88fe5b", "console": [], "id": "ecfG", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "c2d0c974ca4e6dc69e25e70e6530bba3", "console": [], "id": "Pvdt", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "6deb25cae9501c2ee5653a920a0e41d4", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"5-modeling-with-candidate-solutions-non-commercial-use-only\"\u003E\u003Cstrong\u003E5. Modeling with candidate solutions\u003C/strong\u003E [non-commercial use only]\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EUsing an advanced algorithm to create and evaluate models for each feature set of the chosen solution type. Proper train-test cross-validation is run.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EWARNING:\u003C/strong\u003E For downstream modeling, we use TabPFN, whose free licence can be used only for research purposes. \u003Ca href=\"https://huggingface.co/Prior-Labs/tabpfn_2_5\" rel=\"noopener noreferrer\" target=\"_blank\"\u003E(Read more.)\u003C/a\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4751038f6a33a59d43801b431610de4f", "console": [], "id": "aLJB", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "0aba9ee8261389839ec40aa7b6f3d88b", "console": [], "id": "nHfw", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "0a512875b735e3f5903ac2bb09ae464b", "console": [], "id": "xXTn", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": null, "console": [], "id": "AjVT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.19.8"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.19.8%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20sys%0A%20%20%20%20import%20os%0A%0A%20%20%20%20%23%20Add%20the%20parent%20directory%20to%20sys.path%20so%20'gemss'%20can%20be%20imported%0A%20%20%20%20current_dir%20%3D%20os.path.dirname(os.path.abspath(__file__))%0A%20%20%20%20parent_dir%20%3D%20os.path.abspath(os.path.join(current_dir%2C%20%22..%22))%0A%20%20%20%20if%20parent_dir%20not%20in%20sys.path%3A%0A%20%20%20%20%20%20%20%20sys.path.append(parent_dir)%0A%20%20%20%20return%20current_dir%2C%20os%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20io%0A%20%20%20%20from%20plotly%20import%20io%20as%20pio%0A%0A%20%20%20%20%23%20GEMSS%20feature%20selector%0A%20%20%20%20from%20gemss.feature_selection.inference%20import%20BayesianFeatureSelector%0A%0A%20%20%20%20%23%20Visualizations%0A%20%20%20%20from%20gemss.utils.visualizations%20import%20(%0A%20%20%20%20%20%20%20%20show_label_histogram%2C%0A%20%20%20%20%20%20%20%20show_final_alphas%2C%0A%20%20%20%20%20%20%20%20show_features_in_components%2C%0A%20%20%20%20%20%20%20%20get_algorithm_progress_plots%2C%0A%20%20%20%20%20%20%20%20get_final_alphas_plot%2C%0A%20%20%20%20%20%20%20%20get_label_histogram_plot%2C%0A%20%20%20%20%20%20%20%20get_label_piechart%2C%0A%20%20%20%20%20%20%20%20get_features_in_components_plot%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Postprocessing%0A%20%20%20%20from%20gemss.utils.utils%20import%20(%0A%20%20%20%20%20%20%20%20get_solution_summary_df%2C%0A%20%20%20%20%20%20%20%20save_feature_lists_json%2C%0A%20%20%20%20%20%20%20%20save_feature_lists_txt%2C%0A%20%20%20%20%20%20%20%20save_selector_history_json%2C%0A%20%20%20%20%20%20%20%20save_constants_json%2C%0A%20%20%20%20)%0A%20%20%20%20from%20gemss.postprocessing.result_postprocessing%20import%20(%0A%20%20%20%20%20%20%20%20recover_solutions%2C%0A%20%20%20%20%20%20%20%20get_features_from_solutions%2C%0A%20%20%20%20%20%20%20%20get_unique_features%2C%0A%20%20%20%20)%0A%20%20%20%20from%20gemss.postprocessing.simple_regressions%20import%20(%0A%20%20%20%20%20%20%20%20detect_task%2C%0A%20%20%20%20%20%20%20%20solve_any_regression%2C%0A%20%20%20%20%20%20%20%20show_regression_metrics%2C%0A%20%20%20%20)%0A%20%20%20%20from%20gemss.postprocessing.tabpfn_evaluation%20import%20(%0A%20%20%20%20%20%20%20%20tabpfn_evaluate%2C%0A%20%20%20%20)%0A%20%20%20%20from%20gemss.data_handling.data_processing%20import%20(%0A%20%20%20%20%20%20%20%20preprocess_features%2C%0A%20%20%20%20%20%20%20%20get_df_from_X%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Use%20default%20renderer%20or%20'iframe'%20if%20plots%20don't%20show%0A%20%20%20%20%23%20pio.renderers.default%20%3D%20%22notebook_connected%22%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20BayesianFeatureSelector%2C%0A%20%20%20%20%20%20%20%20detect_task%2C%0A%20%20%20%20%20%20%20%20get_algorithm_progress_plots%2C%0A%20%20%20%20%20%20%20%20get_df_from_X%2C%0A%20%20%20%20%20%20%20%20get_features_from_solutions%2C%0A%20%20%20%20%20%20%20%20get_features_in_components_plot%2C%0A%20%20%20%20%20%20%20%20get_final_alphas_plot%2C%0A%20%20%20%20%20%20%20%20get_label_histogram_plot%2C%0A%20%20%20%20%20%20%20%20get_label_piechart%2C%0A%20%20%20%20%20%20%20%20get_solution_summary_df%2C%0A%20%20%20%20%20%20%20%20get_unique_features%2C%0A%20%20%20%20%20%20%20%20io%2C%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20np%2C%0A%20%20%20%20%20%20%20%20pd%2C%0A%20%20%20%20%20%20%20%20preprocess_features%2C%0A%20%20%20%20%20%20%20%20recover_solutions%2C%0A%20%20%20%20%20%20%20%20save_constants_json%2C%0A%20%20%20%20%20%20%20%20save_feature_lists_json%2C%0A%20%20%20%20%20%20%20%20save_feature_lists_txt%2C%0A%20%20%20%20%20%20%20%20save_selector_history_json%2C%0A%20%20%20%20%20%20%20%20solve_any_regression%2C%0A%20%20%20%20%20%20%20%20tabpfn_evaluate%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(current_dir%2C%20mo%2C%20os)%3A%0A%20%20%20%20logo_path%20%3D%20os.path.join(current_dir%2C%20%22datamole_logo_wide.jpg%22)%0A%0A%20%20%20%20%23%20Read%20and%20display%20logo%0A%20%20%20%20logo_link%20%3D%20mo.Html(%0A%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22text-align%3A%20right%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ca%20href%3D%22https%3A%2F%2Fwww.datamole.ai%2F%22%20target%3D%22_blank%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Bmo.image(src%3Dlogo_path%2C%20width%3D1000%2C%20alt%3D%22Datamole%22).text%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fa%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%0A%20%20%20%20mo.image(src%3Dlogo_path%2C%20width%3D1000%2C%20alt%3D%22Datamole%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20%F0%9F%92%8E%20**GEMSS%20Explorer**%20%5Bnon-commercial%5D%0A%0A%20%20%20%20This%20app%20helps%20you%20discover%20**multiple%20distinct%20feature%20sets**%20that%20explain%20your%20data%20using%20GEMSS%3A%20Gaussian%20Ensemble%20for%20Multiple%20Sparse%20Solutions.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20More%20details%0A%20%20%20%20intro_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%20%F0%9F%93%96%20Read%20more%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20What%20you%20will%20get%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Instead%20of%20finding%20just%20one%20%22best%22%20set%20of%20features%2C%20GEMSS%20discovers%20**several%20most%20likely%20feature%20combinations**%20that%20predict%20your%20target%20variable%20comparably%20well.%20This%20is%20valuable%20when%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20You%20have%20precious%20few%20samples%20and%20many%20more%20features%20(common%20e.g.%20in%20life%20sciences).%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Multiple%20underlying%20mechanisms%20might%20explain%20your%20data.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20You%20are%20striving%20for%20an%20interpretable%20model.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20You%20want%20to%20engineer%20a%20multitude%20of%20nonlinear%20and%20combined%20features%20from%20your%20original%20set%20for%20exploratory%20purposes.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Your%20features%20are%20correlated.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20When%20there%20is%20domain%20knowledge%20to%20be%20mined%20(a%20human%20in%20the%20loop).%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Example%3A**%20Instead%20of%20%22use%20features%20A%2C%20B%2C%20C%22%2C%20you%20might%20discover%20three%20solutions%3A%20%7BA%2C%20B%2C%20C%7D%2C%20%7BD%2C%20E%2C%20F%7D%2C%20%7BA%2C%20E%2C%20G%7D%20%E2%80%94%20each%20explaining%20the%20data%20through%20a%20different%20mechanism.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20General%20workflow%20overview%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**I.%20Data%20loading**%20-%20Upload%20and%20configure%20your%20dataset.%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**II.%20Algorithm%20setup**%20-%20Configure%20hyperparameters%20of%20GEMSS%20feature%20selector.%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**III.%20Feature%20selection**%20-%20Run%20Bayesian%20inference%20to%20discover%20multiple%20components%20that%20describe%20your%20data.%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**IV.%20Solution%20recovery**%20-%20Extract%20one%20sparse%20solution%20from%20each%20component%2C%20obtaining%20an%20ensemble%20of%20feature%20sets.%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**V.%20Model%20evaluation**%20-%20Validate%20each%20solution%20by%20a%20simple%20linear%2Flogistic%20regression%20model%20and%20then%20a%20full%20predictive%20model.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Each%20step%20builds%20on%20the%20previous%20one%2C%20so%20please%20follow%20the%20workflow%20in%20order.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Model%20evaluation%20requires%20agreement%20with%20the%20%5Blicense%20of%20TabPFN%5D(https%3A%2F%2Fhuggingface.co%2FPrior-Labs%2Ftabpfn_2_5%23licensing)%20modeling%20tool.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20intro_help%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20**1.%20Set%20up%20input%20and%20output**%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20More%20details%0A%20%20%20%20data_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%20%F0%9F%93%96%20Guide%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20The%20input%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20must%20be%20already%20cleaned%20and%20preprocessed%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20should%20have%20features%20in%20columns%20and%20samples%20in%20rows%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20must%20contain%20an%20index%20column%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20must%20contain%20a%20target%2Flabel%20column%3A%20binary%20classification%20and%20regression%20are%20supported%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20can%20contain%20missing%20values%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20only%20numeric%20features%20are%20supported.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Data%20scaling%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20It%20is%20highly%20recommended%20to%20scale%20your%20data%2C%20unless%20they%20already%20have%20been.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Use%20the%20*minmax*%20scaling%20to%20simply%20squish%20all%20features'%20values%20to%20%5B0%2C%201%5D%20range.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Use%20the%20*standard*%20scaling%20when%20you%20assume%20the%20samples%20are%20normally%20distributed.%20Each%20feature%20will%20then%20have%20mean%200%20and%20standard%20deviation%201.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20The%20outputs%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20When%20saving%20is%20enabled%2C%20the%20following%20files%20will%20be%20created%20in%20the%20specified%20directory%20(names%20can%20be%20customized)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20%60search_history_results.json%60%20-%20JSON%20file%20containing%20the%20history%20of%20the%20feature%20selection%20process%20(backup%20for%20possible%20alternative%20postprocessing)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20%60search_setup.json%60%20-%20JSON%20file%20containing%20the%20configuration%20of%20the%20feature%20selection%20process%20(for%20experiment%20tracking)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20%60feature_lists.txt%60%20-%20human-readable%20text%20file%20containing%20the%20discovered%20feature%20sets%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20%60feature_lists.json%60%20-%20same%20as%20above%2C%20but%20in%20JSON%20format%20for%20easier%20programmatical%20handling%20in%20further%20modeling%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20data_help%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(current_dir%2C%20mo)%3A%0A%20%20%20%20%23%20Save%20configuration%0A%20%20%20%20checkbox_save_results%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20value%3DTrue%2C%0A%20%20%20%20%20%20%20%20label%3D%22Save%20results%22%2C%0A%20%20%20%20)%0A%20%20%20%20save_dir_input%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20value%3Df%22%7Bcurrent_dir%7D%5C%5Cresults%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Parent%20directory%20for%20saving%20this%20experiment%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20save_experiment_id%20%3D%20mo.ui.number(1%2C%201000%2C%20value%3D1%2C%20step%3D1%2C%20label%3D%22Experiment%20ID%22)%0A%20%20%20%20save_history_name%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20value%3D%22search_history_results%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22History%20filename%20(no%20extension)%22%2C%0A%20%20%20%20)%0A%20%20%20%20save_setup_name%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20value%3D%22search_setup%22%2C%20label%3D%22Setup%20filename%20(no%20extension)%22%0A%20%20%20%20)%0A%20%20%20%20save_features_name%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20value%3D%22all_candidate_solutions%22%2C%20label%3D%22Features%20filename%20(no%20extension)%22%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%201.1%20Output%20configuration%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20checkbox_save_results%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20checkbox_save_results%2C%0A%20%20%20%20%20%20%20%20save_dir_input%2C%0A%20%20%20%20%20%20%20%20save_experiment_id%2C%0A%20%20%20%20%20%20%20%20save_features_name%2C%0A%20%20%20%20%20%20%20%20save_history_name%2C%0A%20%20%20%20%20%20%20%20save_setup_name%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20checkbox_save_results%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20save_dir_input%2C%0A%20%20%20%20save_experiment_id%2C%0A%20%20%20%20save_features_name%2C%0A%20%20%20%20save_history_name%2C%0A%20%20%20%20save_setup_name%2C%0A)%3A%0A%20%20%20%20%23%20configure%20saving%20options%2C%20if%20saving%20is%20enabled%0A%20%20%20%20save_results%20%3D%20checkbox_save_results.value%0A%20%20%20%20if%20save_results%3A%0A%20%20%20%20%20%20%20%20_display%20%3D%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22*Output%20files%20will%20be%20saved%20in%3A%20%7Bsave_dir_input.value%7D%2Fexperiment_%7Bsave_experiment_id.value%7D*%2F%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%20Edit%20save%20location%22%3A%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20save_dir_input%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20save_experiment_id%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Edit%20file%20names%22%3A%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20save_history_name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20save_setup_name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20save_features_name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20_display%20%3D%20None%0A%0A%20%20%20%20_display%0A%20%20%20%20return%20(save_results%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20UI%20Components%20for%20Data%20Loading%0A%20%20%20%20file_uploader%20%3D%20mo.ui.file(%0A%20%20%20%20%20%20%20%20kind%3D%22button%22%2C%20label%3D%22Upload%20CSV%20dataset%22%2C%20filetypes%3D%5B%22.csv%22%5D%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%201.2%20Input%20data%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20file_uploader%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20(file_uploader%2C)%0A%0A%0A%40app.cell%0Adef%20_(file_uploader%2C%20io%2C%20mo%2C%20pd)%3A%0A%20%20%20%20%23%20Logic%20to%20load%20data%20from%20uploader%0A%20%20%20%20if%20file_uploader.value%3A%0A%20%20%20%20%20%20%20%20%23%20Load%20CSV%20from%20the%20uploaded%20bytes%0A%20%20%20%20%20%20%20%20_content%20%3D%20file_uploader.value%5B0%5D.contents%0A%20%20%20%20%20%20%20%20df_raw%20%3D%20pd.read_csv(io.BytesIO(_content))%0A%0A%20%20%20%20%20%20%20%20%23%20Column%20selectors%20based%20on%20the%20uploaded%20file%0A%20%20%20%20%20%20%20%20index_col_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dlist(df_raw.columns)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Index%20column%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3Ddf_raw.columns%5B0%5D%20if%20not%20df_raw.empty%20else%20None%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20label_col_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dlist(df_raw.columns)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Target%2Flabel%20column%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3Ddf_raw.columns%5B-1%5D%20if%20not%20df_raw.empty%20else%20None%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20scaling_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3D%5B%22standard%22%2C%20%22minmax%22%2C%20None%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Scaling%20to%20use%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D%22minmax%22%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20allowed_missing_percentage_selector%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2050%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20step%3D5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Missing%20data%20allowed%20in%20a%20feature%20%5B%25%5D%22%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20data_setup_ui%20%3D%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%E2%9C%85%20**Data%20loaded%3A**%20%60%7Bfile_uploader.value%5B0%5D.name%7D%60%20(%7Bdf_raw.shape%5B0%5D%7D%20rows%2C%20%7Bdf_raw.shape%5B1%5D%7D%20cols)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5Bindex_col_selector%2C%20label_col_selector%2C%20scaling_selector%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20df_raw%20%3D%20None%0A%20%20%20%20%20%20%20%20index_col_selector%20%3D%20None%0A%20%20%20%20%20%20%20%20label_col_selector%20%3D%20None%0A%20%20%20%20%20%20%20%20scaling_selector%20%3D%20None%0A%0A%20%20%20%20(%0A%20%20%20%20%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**Your%20loaded%20dataset%3A**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(df_raw)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20if%20df_raw%20is%20not%20None%0A%20%20%20%20%20%20%20%20else%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20allowed_missing_percentage_selector%2C%0A%20%20%20%20%20%20%20%20df_raw%2C%0A%20%20%20%20%20%20%20%20index_col_selector%2C%0A%20%20%20%20%20%20%20%20label_col_selector%2C%0A%20%20%20%20%20%20%20%20scaling_selector%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20allowed_missing_percentage_selector%2C%0A%20%20%20%20df_raw%2C%0A%20%20%20%20get_df_from_X%2C%0A%20%20%20%20get_label_histogram_plot%2C%0A%20%20%20%20get_label_piechart%2C%0A%20%20%20%20index_col_selector%2C%0A%20%20%20%20label_col_selector%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20np%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20preprocess_features%2C%0A%20%20%20%20scaling_selector%2C%0A)%3A%0A%20%20%20%20%23%20Stop%20if%20data%20not%20loaded%0A%20%20%20%20mo.stop(df_raw%20is%20None%2C%20mo.md(%22*Please%20upload%20your%20dataset%20to%20proceed.*%3Cbr%3E%3Chr%3E%22))%0A%0A%20%20%20%20%23%20Data%20Preprocessing%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20_df_proc%20%3D%20df_raw.copy()%0A%20%20%20%20%20%20%20%20if%20index_col_selector.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_df_proc.set_index(index_col_selector.value%2C%20inplace%3DTrue)%0A%0A%20%20%20%20%20%20%20%20_response%20%3D%20_df_proc%5Blabel_col_selector.value%5D%0A%20%20%20%20%20%20%20%20%23%20Preprocess%0A%20%20%20%20%20%20%20%20X%2C%20y%2C%20feature_map%20%3D%20preprocess_features(%0A%20%20%20%20%20%20%20%20%20%20%20%20_df_proc%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20_response%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20dropna%3D%22response%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20allowed_missing_percentage%3Dallowed_missing_percentage_selector.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20drop_non_numeric_features%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20apply_scaling%3Dscaling_selector.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20verbose%3DFalse%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20overall_nan_ratio%20%3D%20np.isnan(X).sum()%20%2F%20(X.shape%5B0%5D%20*%20X.shape%5B1%5D)%0A%20%20%20%20%20%20%20%20df_processed%20%3D%20get_df_from_X(X%2C%20feature_map)%0A%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20mo.stop(True%2C%20mo.md(f%22**Error%20processing%20data%3A**%20%7Bstr(e)%7D%22))%0A%0A%20%20%20%20n_samples%20%3D%20df_processed.shape%5B0%5D%0A%20%20%20%20n_features%20%3D%20df_processed.shape%5B1%5D%0A%20%20%20%20_n_response_values%20%3D%20pd.Series(y).nunique()%0A%0A%20%20%20%20min_samples_allowed%20%3D%2010%0A%20%20%20%20min_features_allowed%20%3D%2010%0A%20%20%20%20too_few_samples%20%3D%20n_samples%20%3C%20min_samples_allowed%0A%20%20%20%20too_few_features%20%3D%20n_features%20%3C%20min_features_allowed%0A%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20too_few_samples%2C%0A%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22**Error%3A%20too%20few%20samples%20available%3A**%20%7Bn_samples%7D%20%3C%20%7Bmin_samples_allowed%7D.%20Fix%20your%20dataset%20before%20proceeding.%22%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20)%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20too_few_features%2C%0A%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22**Error%3A%20too%20few%20features%20available%3A**%20%7Bn_features%7D%20%3C%20%7Bmin_features_allowed%7D.%20Fix%20your%20dataset%20before%20proceeding.%22%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%9C%85%20**Data%20preprocessed%3A**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20no.%20samples%3A%20%7Bn_samples%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20no.%20features%3A%20%7Bn_features%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20no.%20unique%20response%20values%3A%20%7B_n_response_values%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20missing%20data%3A%20%7Boverall_nan_ratio%7D%25%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20show%20label%20distribution%20either%20as%20a%20pie%20chart%20or%20a%20histogram%2C%20depending%20on%20the%20number%20of%20unique%20values%0A%20%20%20%20%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20get_label_piechart(y)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20_n_response_values%20%3C%205%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20get_label_histogram_plot(y)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20X%2C%20df_processed%2C%20feature_map%2C%20n_features%2C%20y%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20**2.%20The%20feature%20selection%20algorithm**%0A%0A%20%20%20%20Configure%20parameters%20of%20the%20GEMSS%20feature%20selection%20algorithm.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_processed%2C%20mo)%3A%0A%20%20%20%20%23%20UI%20for%20Algorithm%20Configuration%0A%20%20%20%20mo.stop(df_processed%20is%20None%2C%20mo.md(%22*Please%20upload%20data%20first.*%22))%0A%0A%20%20%20%20%23%20Basic%20Settings%0A%20%20%20%20n_candidates%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%201%2C%2020%2C%20value%3D8%2C%20step%3D1%2C%20label%3D%22Number%20of%20components%20(candidate%20solutions)%22%0A%20%20%20%20)%0A%20%20%20%20sparsity_est%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%2015%2C%0A%20%20%20%20%20%20%20%20value%3D4%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%0A%20%20%20%20%20%20%20%20label%3D%22Desired%20sparsity%20(no.%20features%20per%20component)%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Advanced%20Settings%0A%20%20%20%20adv_iter%20%3D%20mo.ui.number(500%2C%2020000%2C%20value%3D3500%2C%20step%3D250%2C%20label%3D%22Iterations%22)%0A%20%20%20%20adv_lr%20%3D%20mo.ui.number(0.0000%2C%200.1%2C%20value%3D0.002%2C%20step%3D0.0001%2C%20label%3D%22Learning%20rate%22)%0A%20%20%20%20adv_batch%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%208%2C%0A%20%20%20%20%20%20%20%20256%2C%0A%20%20%20%20%20%20%20%20value%3D16%2C%0A%20%20%20%20%20%20%20%20step%3D4%2C%0A%20%20%20%20%20%20%20%20label%3D%22Batch%20size%20(no.%20samples%20in%20a%20minibatch)%22%2C%0A%20%20%20%20)%0A%20%20%20%20adv_jaccard%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20value%3DTrue%2C%20label%3D%22Enforce%20diversity%20(penalize%20Jaccard%20similarity)%22%0A%20%20%20%20)%0A%20%20%20%20adv_lambda%20%3D%20mo.ui.number(0%2C%2020000%2C%20value%3D1000%2C%20step%3D250%2C%20label%3D%22Lambda%22)%0A%20%20%20%20adv_var_spike%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%2010%2C%0A%20%20%20%20%20%20%20%20value%3D0.1%2C%0A%20%20%20%20%20%20%20%20step%3D0.005%2C%0A%20%20%20%20%20%20%20%20label%3D%22Spike%20distribution%20variance%22%2C%0A%20%20%20%20)%0A%20%20%20%20adv_var_slab%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%201000%2C%0A%20%20%20%20%20%20%20%20value%3D100%2C%0A%20%20%20%20%20%20%20%20step%3D10%2C%0A%20%20%20%20%20%20%20%20label%3D%22Slab%20distribution%20variance%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Parameter%20help%20text%0A%20%20%20%20parameter_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%F0%9F%93%96%20Parameter%20guide%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Basic%20parameters%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Number%20of%20components%3A**%20How%20many%20distinct%20feature%20sets%20to%20discover.%20It%20is%20recommended%20to%20overshoot%20this%20number%20(2-3x)%2C%20especially%20in%20adverse%20conditions.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Estimated%20sparsity%3A**%20Expected%20number%20of%20features%20per%20solution.%20This%20guides%20the%20algorithm's%20search.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Advanced%20optimization%20settings%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Iterations%3A**%20More%20iterations%20improve%20convergence%20but%20take%20longer%20(typical%3A%203000-5000).%20Increase%20if%20ELBO%20hasn't%20converged%20or%20features'%20mu%20values%20are%20still%20changing.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Learning%20rate%3A**%20Controls%20%5BSGD%20optimization%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FStochastic_gradient_descent)%20step%20size%20(typical%3A%200.001-0.003).%20Decrease%20if%20training%20is%20unstable%2C%20increase%20if%20progress%20is%20too%20slow.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Batch%20size%3A**%20Number%20of%20samples%20used%20in%20one%20SGD%20optimization%20step%20(typical%3A%2016-64).%20Increase%20for%20datasets%20with%20missing%20data%2C%20noise%2C%20or%20class%20imbalance.%20Increasing%20batch%20size%20proportionally%20increases%20run%20time.%20Recommendation%3A%20have%20at%20least%204%20samples%20of%20the%20minority%20class%20in%20one%20batch.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Enforce%20diversity%3A**%20Penalizes%20average%20similarity%20(%5BJaccard%20index%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FJaccard_index))%20of%20solutions%20to%20promote%20diverse%20feature%20combinations.%20Enable%20when%20you%20want%20to%20push%20more%20towards%20distinct%20explanatory%20mechanisms.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Lambda%3A**%20Strength%20of%20diversity%20penalty%20(typical%3A%200-2000).%20Higher%20values%20%E2%86%92%20more%20different%20solutions.%20Increase%20if%20solutions%20overlap%20too%20much.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ci%3E**Example%20batch%20size%20setup.**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Let%20your%20dataset%20contain%20200%20samples%3A%20160x%20class%20A%2C%2040x%20class%20B%20(i.e.%20the%20minority%20class%20makes%20up%2020%25%20samples).%20There%20is%20low%20noise%20and%20no%20missing%20data.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20It%20is%20desirable%20to%20have%20*at%20least*%204%20samples%20from%20each%20class%20in%20a%20batch%20(empirical%20observation)%20%3D%3E%20batch%20size%20%3D%204%20*%20(1%2F0.20)%20%3D%2020%20samples.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fi%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Advanced%20prior%20settings%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20These%20control%20how%20the%20algorithm%20balances%20sparsity%20(few%20features)%20vs.%20explanatory%20power%20(including%20relevant%20features).%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20This%20algorithm%20uses%20the%20%5BStructured%20Spike-and-Slab%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSpike-and-slab_regression)%20%5Bprior%20distribution%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPrior_probability)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20that%20is%20a%20mixture%20of%20two%20Gaussian%20distributions.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Each%20feature%20is%20assigned%20to%20either%20the%20wide%20distribution%20(Slab)%20or%20the%20steep%20distribution%20(Spike).%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Spike%20variance%3A**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Is%20the%20most%20important%20parameter%20for%20controlling%20convergence.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Controls%20sparsity%20strength%20(typical%3A%200.05-0.5).%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Increase%20if%20all%20features%20converge%20to%200%20(over-regularization).%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Decrease%20carefully%20if%20too%20many%20features%20are%20selected%20(under-regularization).%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Slab%20variance%3A**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Scale%20for%20non-zero%20features%20(typical%3A%2050-200).%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Adjust%20together%20with%20spike%20variance%20to%20improve%20feature%20discrimination.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20settings_ui%20%3D%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20parameter_help%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5Bn_candidates%2C%20sparsity_est%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Advanced%20optimization%20settings%22%3A%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Badv_iter%2C%20adv_lr%2C%20adv_batch%2C%20adv_jaccard%2C%20adv_lambda%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Advanced%20prior%20settings%20(Structured%20Spike-and-Slab)%22%3A%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Badv_var_spike%2C%20adv_var_slab%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20settings_ui%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20adv_batch%2C%0A%20%20%20%20%20%20%20%20adv_iter%2C%0A%20%20%20%20%20%20%20%20adv_jaccard%2C%0A%20%20%20%20%20%20%20%20adv_lambda%2C%0A%20%20%20%20%20%20%20%20adv_lr%2C%0A%20%20%20%20%20%20%20%20adv_var_slab%2C%0A%20%20%20%20%20%20%20%20adv_var_spike%2C%0A%20%20%20%20%20%20%20%20n_candidates%2C%0A%20%20%20%20%20%20%20%20sparsity_est%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(df_processed%2C%20mo)%3A%0A%20%20%20%20mo.stop(df_processed%20is%20None%2C%20%22%22)%0A%0A%20%20%20%20%23%20The%20big%20RUN%20FEATURE%20SELECTION%20button%0A%20%20%20%20run_btn%20%3D%20mo.ui.run_button(label%3D%22Run%20feature%20selection%22%2C%20kind%3D%22success%22)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20run_btn%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20(run_btn%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20BayesianFeatureSelector%2C%0A%20%20%20%20X%2C%0A%20%20%20%20adv_batch%2C%0A%20%20%20%20adv_iter%2C%0A%20%20%20%20adv_jaccard%2C%0A%20%20%20%20adv_lambda%2C%0A%20%20%20%20adv_lr%2C%0A%20%20%20%20adv_var_slab%2C%0A%20%20%20%20adv_var_spike%2C%0A%20%20%20%20df_raw%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20n_candidates%2C%0A%20%20%20%20run_btn%2C%0A%20%20%20%20sparsity_est%2C%0A%20%20%20%20y%2C%0A)%3A%0A%20%20%20%20%23%20Main%20execution%20logic%0A%0A%20%20%20%20%23%201.%20Stop%20if%20data%20not%20loaded%0A%20%20%20%20mo.stop(df_raw%20is%20None%2C%20mo.md(%22*Please%20upload%20data%20first.*%22))%0A%0A%20%20%20%20%23%202.%20Stop%20if%20button%20not%20pressed%0A%20%20%20%20mo.stop(not%20run_btn.value%2C%20mo.md(%22*Ready%20to%20run.%20Click%20start%20above.*%22))%0A%0A%20%20%20%20%23%20Optimization%3A%20class%20setup%0A%20%20%20%20selector%20%3D%20BayesianFeatureSelector(%0A%20%20%20%20%20%20%20%20n_features%3DX.shape%5B1%5D%2C%0A%20%20%20%20%20%20%20%20n_components%3Dn_candidates.value%2C%0A%20%20%20%20%20%20%20%20X%3DX%2C%0A%20%20%20%20%20%20%20%20y%3Dy%2C%0A%20%20%20%20%20%20%20%20prior%3D%22sss%22%2C%0A%20%20%20%20%20%20%20%20sss_sparsity%3Dsparsity_est.value%2C%0A%20%20%20%20%20%20%20%20var_slab%3Dadv_var_slab.value%2C%0A%20%20%20%20%20%20%20%20var_spike%3Dadv_var_spike.value%2C%0A%20%20%20%20%20%20%20%20lr%3Dadv_lr.value%2C%0A%20%20%20%20%20%20%20%20batch_size%3Dadv_batch.value%2C%0A%20%20%20%20%20%20%20%20n_iter%3Dadv_iter.value%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Run%20optimizer%0A%20%20%20%20history%20%3D%20selector.optimize(%0A%20%20%20%20%20%20%20%20regularize%3Dadv_jaccard.value%2C%0A%20%20%20%20%20%20%20%20lambda_jaccard%3Dadv_lambda.value%2C%0A%20%20%20%20%20%20%20%20verbose%3DTrue%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(history%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20X%2C%0A%20%20%20%20adv_batch%2C%0A%20%20%20%20adv_iter%2C%0A%20%20%20%20adv_jaccard%2C%0A%20%20%20%20adv_lambda%2C%0A%20%20%20%20adv_lr%2C%0A%20%20%20%20adv_var_slab%2C%0A%20%20%20%20adv_var_spike%2C%0A%20%20%20%20n_candidates%2C%0A%20%20%20%20os%2C%0A%20%20%20%20save_dir_input%2C%0A%20%20%20%20save_experiment_id%2C%0A%20%20%20%20save_features_name%2C%0A%20%20%20%20save_history_name%2C%0A%20%20%20%20save_results%2C%0A%20%20%20%20save_setup_name%2C%0A%20%20%20%20sparsity_est%2C%0A)%3A%0A%20%20%20%20%23%20Saving%20setup%0A%20%20%20%20if%20save_results%3A%0A%20%20%20%20%20%20%20%20%23%20Configure%20saving%20options%2C%20if%20saving%20is%20enabled%0A%20%20%20%20%20%20%20%20%23%20Prepare%20directory%0A%20%20%20%20%20%20%20%20experiment_dir%20%3D%20f%22%7Bsave_dir_input.value%7D%2Fexperiment_%7Bsave_experiment_id.value%7D%22%0A%20%20%20%20%20%20%20%20os.makedirs(experiment_dir%2C%20exist_ok%3DTrue)%0A%0A%20%20%20%20%20%20%20%20%23%20Prepare%20save%20paths%0A%20%20%20%20%20%20%20%20history_path%20%3D%20f%22%7Bexperiment_dir%7D%2F%7Bsave_history_name.value%7D.json%22%0A%20%20%20%20%20%20%20%20setup_path%20%3D%20f%22%7Bexperiment_dir%7D%2F%7Bsave_setup_name.value%7D.json%22%0A%20%20%20%20%20%20%20%20features_path_json%20%3D%20f%22%7Bexperiment_dir%7D%2F%7Bsave_features_name.value%7D.json%22%0A%20%20%20%20%20%20%20%20features_path_txt%20%3D%20f%22%7Bexperiment_dir%7D%2F%7Bsave_features_name.value%7D.txt%22%0A%0A%20%20%20%20%20%20%20%20%23%20Define%20constants%20that%20are%20to%20be%20saved%0A%20%20%20%20%20%20%20%20constants%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22N_SAMPLES%22%3A%20X.shape%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22N_FEATURES%22%3A%20X.shape%5B1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22N_CANDIDATE_SOLUTIONS%22%3A%20n_candidates.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22SPARSITY%22%3A%20sparsity_est.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22PRIOR_SPARSITY%22%3A%20sparsity_est.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22PRIOR_TYPE%22%3A%20%22sss%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22VAR_SPIKE%22%3A%20adv_var_spike.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22VAR_SLAB%22%3A%20adv_var_slab.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22N_ITER%22%3A%20adv_iter.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22LEARNING_RATE%22%3A%20adv_lr.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22BATCH_SIZE%22%3A%20adv_batch.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22IS_REGULARIZED%22%3A%20adv_jaccard.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22LAMBDA_JACCARD%22%3A%20adv_lambda.value%2C%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20experiment_dir%20%3D%20None%0A%20%20%20%20%20%20%20%20history_path%20%3D%20None%0A%20%20%20%20%20%20%20%20setup_path%20%3D%20None%0A%20%20%20%20%20%20%20%20features_path_json%20%3D%20None%0A%20%20%20%20%20%20%20%20features_path_txt%20%3D%20None%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20constants%2C%0A%20%20%20%20%20%20%20%20experiment_dir%2C%0A%20%20%20%20%20%20%20%20features_path_json%2C%0A%20%20%20%20%20%20%20%20features_path_txt%2C%0A%20%20%20%20%20%20%20%20history_path%2C%0A%20%20%20%20%20%20%20%20setup_path%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20constants%2C%0A%20%20%20%20experiment_dir%2C%0A%20%20%20%20history%2C%0A%20%20%20%20history_path%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20save_constants_json%2C%0A%20%20%20%20save_results%2C%0A%20%20%20%20save_selector_history_json%2C%0A%20%20%20%20setup_path%2C%0A)%3A%0A%20%20%20%20%23%20Save%20history%20and%20setup%20immediately%20after%20optimization%0A%20%20%20%20if%20save_results%3A%0A%20%20%20%20%20%20%20%20%23%20Save%20history%20and%20constants%0A%20%20%20%20%20%20%20%20msg_history%20%3D%20save_selector_history_json(history%2C%20history_path)%0A%20%20%20%20%20%20%20%20msg_constants%20%3D%20save_constants_json(constants%2C%20setup_path)%0A%0A%20%20%20%20%20%20%20%20%23%20Stack%20output%20messages%0A%20%20%20%20%20%20%20%20_display%20%3D%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%E2%9C%85%20**Optimization%20Complete!**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%F0%9F%93%81%20Optimization%20history%20saved%20to%3A%20%60%7Bexperiment_dir%7D%60%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22-%20%7Bmsg_history%7D%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22-%20%7Bmsg_constants%7D%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20_display%20%3D%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%E2%9C%85%20**Optimization%20Complete!**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20_display%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20**3.%20Algorithm%20progress%20history**%0A%0A%20%20%20%20Assess%20convergence%20and%20features%20in%20the%20components.%20If%20needed%2C%20adjust%20the%20algorithm's%20parameters%20and%20rerun.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20adv_iter%2C%0A%20%20%20%20feature_map%2C%0A%20%20%20%20get_algorithm_progress_plots%2C%0A%20%20%20%20get_final_alphas_plot%2C%0A%20%20%20%20history%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20n_features%2C%0A)%3A%0A%20%20%20%20mo.stop(history%20is%20None%2C%20%22%22)%20%20%23%20Show%20only%20after%20feature%20selector%20is%20run%0A%0A%20%20%20%20%23%20Visualization%20of%20algorithm%20trajectories%0A%0A%20%20%20%20%23%20Get%20progress%20plots%0A%20%20%20%20progress_plots_dict%20%3D%20get_algorithm_progress_plots(%0A%20%20%20%20%20%20%20%20history%2C%0A%20%20%20%20%20%20%20%20elbo%3DTrue%2C%0A%20%20%20%20%20%20%20%20mu%3DTrue%2C%0A%20%20%20%20%20%20%20%20alpha%3DFalse%2C%0A%20%20%20%20%20%20%20%20original_feature_names_mapping%3Dfeature_map%2C%0A%20%20%20%20%20%20%20%20subsample_history_for_plotting%3D(%0A%20%20%20%20%20%20%20%20%20%20%20%20True%20if%20((adv_iter.value%20%3E%204000)%20or%20(n_features%20%3E%2080))%20else%20False%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20alphas_plots%20%3D%20get_final_alphas_plot(%0A%20%20%20%20%20%20%20%20history%2C%0A%20%20%20%20%20%20%20%20show_bar_plot%3DFalse%2C%0A%20%20%20%20%20%20%20%20show_pie_chart%3DTrue%2C%0A%20%20%20%20)%0A%20%20%20%20alpha_piechart%20%3D%20alphas_plots%5B0%5D%0A%0A%20%20%20%20%23%20Elbo%20convergence%20help%20text%0A%20%20%20%20elbo_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%20%F0%9F%93%96%20Guide%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20%5BELBO%20(Evidence%20Lower%20BOund)%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FEvidence_lower_bound)%20is%20the%20objective%20function%20that%20the%20algorithm%20maximizes%2C%20possibly%20combined%20with%20penalization%3A%20%24ELBO%20-%20%5Clambda%20*%20penalty%24%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20objective%20function's%20value%20should%20steadily%20increase%20and%20eventually%20plateau%20just%20below%20zero.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Note%20that%20oscillations%20occur%20naturally%20due%20to%20inherent%20stochasticity.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**What%20to%20look%20for%3A**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Good%20convergence%3A**%20Steady%20upward%20trend%20that%20flattens%20into%20a%20plateau.%20The%20curve%20should%20stabilize%20before%20the%20end%20of%20iterations.%20The%20final%2010-20%25%20of%20iterations%20should%20show%20minimal%20change.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Not%20converged%3A**%20Still%20increasing%20steeply%20at%20the%20end%20%E2%86%92%20increase%20number%20of%20iterations.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Unstable%3A**%20Erratic%20oscillations%20are%20not%20dampened%20over%20time%20%E2%86%92%20decrease%20learning%20rate%20or%20adjust%20batch%20size.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Too%20high%20absolute%20value%3A**%20Values%20in%20millions%20or%20more%20signify%20a%20major%20problem%20with%20the%20algorithm%20setup.%20Assess%20the%20features'%20trajectories%20below.%20(Values%20in%20low%20thousands%2C%20depending%20on%20lambda%2C%20are%20generally%20favorable.)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Feature%20convergence%20help%20text%0A%20%20%20%20mu_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%20%F0%9F%93%96%20Guide%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**These%20plots%20are%20crucial%20for%20assessment%20of%20whether%20the%20feature%20selector%20produced%20sensible%20results.**%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Each%20plot%20shows%20how%20feature%20importance%20values%20(mu)%20evolve%20during%20optimization%20for%20one%20component.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20algorithm%20assigns%20each%20feature%20to%20either%20the%20Spike%20(near%20zero)%20or%20Slab%20(non-zero)%20distribution.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**What%20to%20look%20for%3A**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Good%20separation%3A**%20Clear%20gap%20between%20features%20converging%20to%20~0%20and%20features%20with%20significant%20non-zero%20values.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Optimization%20process%3A**%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Problem%20indicators%3A**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**All%20features%20%E2%86%92%200%3A**%20Over-regularization.%20Increase%20spike%20variance.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Features'%20ordering%20does%20not%20change%20over%20time%3A**%20May%20indicate%20under-regularization.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Too%20many%20non-zero%20features%3A**%20May%20indicate%20under-regularization.%20Carefully%20decrease%20spike%20variance%20and%2For%20enforce%20stronger%20sparsity.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Oscillating%20values%3A**%20Learning%20rate%20too%20high%20or%20batch%20size%20too%20small.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**Set%20of%20important%20features%20changes%20multiple%20times%20over%20time**%20(situation%3A%20while%20most%20features%20converge%20to%200%2C%20a%20few%20become%20nonzero.%20Then%20the%20nonzero%20features%20become%200%20and%20others%20emerge.%20The%20set%20of%20important%20features%20significantly%20changes%20multiple%20times.)%3A%20The%20algorithm%20cannot%20find%20any%20significant%20signal%20among%20noise.%20May%20indicate%20fundamental%20problem%20with%20the%20dataset.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Alpha%20help%20text%0A%20%20%20%20alpha_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%20%F0%9F%93%96%20Guide%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20pie%20chart%20shows%20how%20the%20algorithm%20distributes%20probability%20mass%20across%20the%20components.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(Alphas%20represent%20the%20mixing%20weights%20in%20the%20%5BGaussian%20mixture%20model%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMixture_model)%20that%20approximate%20the%20%5Bposterior%20distribution%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPosterior_probability).)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20alphas%20should%20correspond%20to%20the%20predictive%20potential%20of%20the%20components.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**What%20to%20look%20for%3A**%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**(Un)balanced%20distribution%3A**%20If%20you%20expect%20multiple%20solutions%20of%20comparable%20significance%2C%20alphas%20should%20be%20relatively%20balanced%20across%20components.%20If%20some%20components%20dominate%2C%20too%20many%20components%20may%20have%20been%20requested%20(i.e.%20the%20dataset%20supports%20fewer%20distinct%20solutions).%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%203.1%20Objective%20function%20convergence%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20elbo_help%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20progress_plots_dict%5B%22elbo%22%5D.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%20width%3D200%20%2B%20adv_iter.value%20%2F%208%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%203.2%20Feature%20convergence%20in%20components%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mu_help%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Unpack%20all%20mu%20plots%0A%20%20%20%20%20%20%20%20%20%20%20%20*%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20progress_plots_dict%5B_plot%5D.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%20width%3D400%20%2B%20adv_iter.value%20%2F%208%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20_plot%20in%20progress_plots_dict.keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20%22mu_%22%20in%20_plot%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%203.3%20Relative%20importances%20of%20components%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha_help%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20alpha_piechart.update_layout(height%3D450%2C%20width%3D450)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20**4.%20Recover%20solutions%20from%20components**%0A%0A%20%20%20%20Each%20component%20can%20be%20handled%20in%20multiple%20ways%20to%20yield%20feature%20sets%20%3D%20candidate%20solutions.%20Select%20your%20strategy.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_processed%2C%20history%2C%20mo%2C%20sparsity_est)%3A%0A%20%20%20%20mo.stop(history%20is%20None%2C%20%22%22)%20%20%23%20Show%20only%20after%20feature%20selector%20is%20run%0A%0A%20%20%20%20%23%20checkboxes%20to%20pick%20solution%20types%0A%20%20%20%20checkbox_out20_sol%20%3D%20mo.ui.checkbox(label%3D%22Outliers%20with%20STD%20%3E%202.0%22%2C%20value%3DTrue)%0A%20%20%20%20checkbox_out25_sol%20%3D%20mo.ui.checkbox(label%3D%22Outliers%20with%20STD%20%3E%202.5%22%2C%20value%3DTrue)%0A%20%20%20%20checkbox_out30_sol%20%3D%20mo.ui.checkbox(label%3D%22Outliers%20with%20STD%20%3E%203.0%22%2C%20value%3DTrue)%0A%20%20%20%20checkbox_out35_sol%20%3D%20mo.ui.checkbox(label%3D%22Outliers%20with%20STD%20%3E%203.5%22%2C%20value%3DFalse)%0A%20%20%20%20checkbox_top_sol%20%3D%20mo.ui.checkbox(label%3D%22Top%20few%20features%22%2C%20value%3DFalse)%0A%20%20%20%20checkbox_full_sol%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20label%3D%22All%20features%20with%20mu%20%3E%20threshold%22%2C%20value%3DFalse%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20advanced%20settings%0A%20%20%20%20top_n_features_selector%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%201%2C%0A%20%20%20%20%20%20%20%20df_processed.shape%5B1%5D%2C%0A%20%20%20%20%20%20%20%20value%3Dsparsity_est.value%2C%0A%20%20%20%20%20%20%20%20label%3D%22Hard%20number%20of%20top%20features%20to%20be%20selected%20('top'%20solution%20type).%22%2C%0A%20%20%20%20)%0A%20%20%20%20min_mu_selector%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%200%2C%0A%20%20%20%20%20%20%20%205%2C%0A%20%20%20%20%20%20%20%20value%3D0.25%2C%0A%20%20%20%20%20%20%20%20label%3D%22'Zero'%20threshold%20for%20mu%20values%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20display%20options%0A%20%20%20%20checkbox_summary%20%3D%20mo.ui.checkbox(label%3D%22Summary%22%2C%20value%3DTrue%2C%20disabled%3DTrue)%0A%20%20%20%20checkbox_matrix%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20label%3D%22Feature%20distribution%20across%20components%22%2C%20value%3DTrue%0A%20%20%20%20)%0A%20%20%20%20checkbox_regression_l2%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20label%3D%22Regression%20with%20l2%20regularization%22%2C%20value%3DTrue%0A%20%20%20%20)%0A%20%20%20%20checkbox_regression_l1%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20label%3D%22Regression%20with%20l1%20regularization%22%2C%20value%3DFalse%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20description%20of%20solution%20types%0A%20%20%20%20solution_recovery_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%20%F0%9F%93%96%20Guide%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Solution%20recovery%20strategies%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Each%20component%20from%20the%20feature%20selector%20contains%20information%20about%20feature%20importance%20(mu%20values).%20These%20can%20be%20converted%20into%20feature%20sets%20(candidate%20solutions)%20using%20different%20strategies%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Outlier-based%20solutions**%20(recommended)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Identifies%20features%20with%20unusually%20high%20%7Cmu%7C%20values%20using%20%5Bstatistical%20outlier%20detection%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FOutlier).%20Features%20are%20selected%20if%20their%20%7Cmu%7C%20exceeds%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**STD%20%3E%202.0**%3A%20Most%20inclusive%20(2%20standard%20deviations%20from%20mean)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**STD%20%3E%202.5**%3A%20Moderately%20selective%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**STD%20%3E%203.0**%3A%20More%20selective%20(common%20choice)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**STD%20%3E%203.5**%3A%20Most%20restrictive%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Top-few%20solutions**%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Selects%20a%20fixed%20number%20of%20top%20features%20with%20highest%20%7Cmu%7C%20values.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20number%20is%20specified%20in%20the%20advanced%20settings%20below.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Thresholded%20solutions**%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Selects%20all%20features%20with%20%7Cmu%7C%20values%20above%20an%20arbitrary%20threshold%20(defined%20in%20the%20advanced%20settings%20below).%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20This%20approach%20is%20useful%20for%20further%20assessment%20of%20importance%20of%20the%20features%20selected%20in%20other%20strategies%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20because%20it%20can%20order%20all%20features%20in%20a%20component%20based%20on%20their%20%7Cmu%7C%20values.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20For%20example%2C%20if%20a%20feature%20has%20a%20significant%20%7Cmu%7C%20value%20in%20only%20one%20component%20with%20generously%20set%20threshold%2C%20it%20is%20likely%20noise.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Important%20features%20usually%20have%20significant%20%7Cmu%7C%20values%20in%20multiple%20components.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20description%20of%20solution%20display%20options%0A%20%20%20%20solution_display_help%20%3D%20mo.accordion(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%20%F0%9F%93%96%20Guide%22%3A%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20For%20each%20solution%20type%2C%20you%20can%20display%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Summary**%20(always%20shown)%3A%20Table%20listing%20all%20features%20in%20each%20component%20with%20their%20mu%20values%2C%20sorted%20by%20importance.%20Helps%20you%20understand%20which%20features%20the%20algorithm%20selected%20and%20their%20relative%20importance%20in%20the%20model.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Feature%20distribution%20across%20components**%3A%20Heatmap%2Fmatrix%20showing%20which%20features%20appear%20in%20which%20components.%20Useful%20for%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Identifying%20features%20that%20appear%20across%20multiple%20components%20(potentially%20robust%20predictors)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Checking%20solution%20diversity%20(do%20different%20components%20select%20different%20features%3F)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20Understanding%20feature%20overlap%20patterns%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20**Regression%20validation**%3A%20Quick%20assessment%20of%20each%20solution's%20predictive%20performance%20using%20simple%20linear%2Flogistic%20regression%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**L2%20regularization**%20(Ridge)%3A%20Handles%20correlated%20features%20well%2C%20generally%20more%20stable%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20**L1%20regularization**%20(Lasso)%3A%20Performs%20additional%20feature%20selection%2C%20may%20be%20more%20interpretable%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E2%9A%A0%EF%B8%8F%20**Important%3A**%20These%20regression%20metrics%20use%20the%20*same%20data%20for%20training%20and%20testing*%20(no%20cross-validation)%2C%20so%20they%20provide%20only%20a%20preliminary%20quality%20check.%20For%20rigorous%20evaluation%2C%20create%20full%20models.%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20The%20regression%20results%20help%20you%20quickly%20identify%20which%20solutions%20show%20promise%20before%20investing%20time%20in%20full%20model%20evaluation.%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20Pick%20solution%20types%20to%20be%20recovered%20from%20components%3A%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20solution_recovery_help%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_out20_sol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_out25_sol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_out30_sol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_out35_sol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_top_sol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_full_sol%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.accordion(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Advanced%20setting%22%3A%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Btop_n_features_selector%2C%20min_mu_selector%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20Pick%20what%20is%20to%20be%20shown%3A%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20solution_display_help%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_summary%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_matrix%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_regression_l2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_regression_l1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20checkbox_full_sol%2C%0A%20%20%20%20%20%20%20%20checkbox_matrix%2C%0A%20%20%20%20%20%20%20%20checkbox_out20_sol%2C%0A%20%20%20%20%20%20%20%20checkbox_out25_sol%2C%0A%20%20%20%20%20%20%20%20checkbox_out30_sol%2C%0A%20%20%20%20%20%20%20%20checkbox_out35_sol%2C%0A%20%20%20%20%20%20%20%20checkbox_regression_l1%2C%0A%20%20%20%20%20%20%20%20checkbox_regression_l2%2C%0A%20%20%20%20%20%20%20%20checkbox_top_sol%2C%0A%20%20%20%20%20%20%20%20min_mu_selector%2C%0A%20%20%20%20%20%20%20%20top_n_features_selector%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(history%2C%20mo)%3A%0A%20%20%20%20mo.stop(history%20is%20None%2C%20%22%22)%20%20%23%20Show%20only%20after%20feature%20selector%20is%20run%0A%0A%20%20%20%20%23%20The%20big%20RUN%20button%0A%20%20%20%20recover_btn%20%3D%20mo.ui.run_button(label%3D%22Recover%20solutions%22%2C%20kind%3D%22success%22)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20recover_btn%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20(recover_btn%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20checkbox_full_sol%2C%0A%20%20%20%20checkbox_matrix%2C%0A%20%20%20%20checkbox_out20_sol%2C%0A%20%20%20%20checkbox_out25_sol%2C%0A%20%20%20%20checkbox_out30_sol%2C%0A%20%20%20%20checkbox_out35_sol%2C%0A%20%20%20%20checkbox_regression_l1%2C%0A%20%20%20%20checkbox_regression_l2%2C%0A%20%20%20%20checkbox_top_sol%2C%0A%20%20%20%20detect_task%2C%0A%20%20%20%20df_raw%2C%0A%20%20%20%20experiment_dir%2C%0A%20%20%20%20feature_map%2C%0A%20%20%20%20features_path_json%2C%0A%20%20%20%20features_path_txt%2C%0A%20%20%20%20get_features_from_solutions%2C%0A%20%20%20%20get_features_in_components_plot%2C%0A%20%20%20%20get_solution_summary_df%2C%0A%20%20%20%20get_unique_features%2C%0A%20%20%20%20history%2C%0A%20%20%20%20min_mu_selector%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20recover_btn%2C%0A%20%20%20%20recover_solutions%2C%0A%20%20%20%20save_feature_lists_json%2C%0A%20%20%20%20save_feature_lists_txt%2C%0A%20%20%20%20save_results%2C%0A%20%20%20%20scaling_selector%2C%0A%20%20%20%20solve_any_regression%2C%0A%20%20%20%20top_n_features_selector%2C%0A%20%20%20%20y%2C%0A)%3A%0A%20%20%20%20mo.stop(history%20is%20None%2C%20%22%22)%20%20%23%20Show%20only%20after%20feature%20selector%20is%20run%0A%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20not%20recover_btn.value%2C%0A%20%20%20%20%20%20%20%20mo.md(%22*Ready%20to%20recover%20solutions%20from%20components.%20Click%20button%20above.*%22)%2C%0A%20%20%20%20)%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20(top_n_features_selector.value%20is%20None)%20or%20(top_n_features_selector.value%20%3C%201)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22Please%20set%20'top%20few%20features'%20to%20value%201%20or%20more.%22)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Define%20which%20outliers%20are%20to%20be%20recovered%0A%20%20%20%20outlier_deviation_thresholds%20%3D%20%5B%5D%0A%20%20%20%20if%20checkbox_out20_sol.value%3A%0A%20%20%20%20%20%20%20%20outlier_deviation_thresholds.append(2.0)%0A%20%20%20%20if%20checkbox_out25_sol.value%3A%0A%20%20%20%20%20%20%20%20outlier_deviation_thresholds.append(2.5)%0A%20%20%20%20if%20checkbox_out30_sol.value%3A%0A%20%20%20%20%20%20%20%20outlier_deviation_thresholds.append(3.0)%0A%20%20%20%20if%20checkbox_out35_sol.value%3A%0A%20%20%20%20%20%20%20%20outlier_deviation_thresholds.append(3.5)%0A%0A%20%20%20%20%23%20Recover%20solutions%0A%20%20%20%20sol_full%2C%20sol_top%2C%20sol_outliers%2C%20_%20%3D%20recover_solutions(%0A%20%20%20%20%20%20%20%20search_history%3Dhistory%2C%0A%20%20%20%20%20%20%20%20desired_sparsity%3Dtop_n_features_selector.value%2C%0A%20%20%20%20%20%20%20%20min_mu_threshold%3Dmin_mu_selector.value%2C%0A%20%20%20%20%20%20%20%20original_feature_names_mapping%3Dfeature_map%2C%0A%20%20%20%20%20%20%20%20use_median_for_outlier_detection%3DFalse%2C%0A%20%20%20%20%20%20%20%20outlier_deviation_thresholds%3Doutlier_deviation_thresholds%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Put%20all%20the%20requested%20solution%20types%20into%20a%20single%20dictionary%0A%20%20%20%20all_solutions%20%3D%20%7B%7D%0A%20%20%20%20for%20_key%2C%20_outlier%20in%20sol_outliers.items()%3A%0A%20%20%20%20%20%20%20%20all_solutions%5Bf%22Outlier%20features%20(%7B'%20%3D%20'.join(_key.split(sep%3D'_'))%7D)%22%5D%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20_outlier%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20if%20checkbox_top_sol.value%3A%0A%20%20%20%20%20%20%20%20all_solutions%5B%22Top%20features%22%5D%20%3D%20sol_top%0A%20%20%20%20if%20checkbox_full_sol.value%3A%0A%20%20%20%20%20%20%20%20all_solutions%5B%22Thresholded%20features%22%5D%20%3D%20sol_full%0A%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20all_solutions%20%3D%3D%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20mo.md(%22Cannot%20proceed.%20Please%20pick%20a%20solution%20type%20to%20recover.%22)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Extract%20which%20features%20are%20contained%20in%20which%20solution%20type%0A%20%20%20%20%23%20Get%20overviews%20and%20simple%20performance%20metrics%0A%20%20%20%20solution_summary%20%3D%20(%0A%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20)%20%20%23%20one%20dateframe%20per%20solution%20type%3A%20feature%20names%20with%20mu%20values%0A%20%20%20%20all_feature_sets%20%3D%20%7B%7D%20%20%23%20features%20per%20component%2C%20for%20each%20solution%20type%0A%20%20%20%20unique_features_found%20%3D%20(%0A%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20)%20%20%23%20all%20unique%20features%20across%20all%20components%20of%20a%20solution%20type%0A%20%20%20%20regression_metrics_l1%20%3D%20%7B%7D%0A%20%20%20%20regression_metrics_l2%20%3D%20%7B%7D%0A%0A%20%20%20%20for%20_type%2C%20_solution%20in%20all_solutions.items()%3A%0A%20%20%20%20%20%20%20%20solution_summary%5B_type%5D%20%3D%20get_solution_summary_df(_solution)%0A%20%20%20%20%20%20%20%20all_feature_sets%5B_type%5D%20%3D%20get_features_from_solutions(_solution)%0A%20%20%20%20%20%20%20%20unique_features_found%5B_type%5D%20%3D%20get_unique_features(all_feature_sets%5B_type%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Quick%20validation%20with%20simple%20linear%2Flogistic%20regression%0A%20%20%20%20%20%20%20%20%23%20l2-regularized%0A%20%20%20%20%20%20%20%20if%20checkbox_regression_l2.value%20and%20(df_raw%20is%20not%20None)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20regression_metrics_l2%5B_type%5D%20%3D%20solve_any_regression(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20solutions%3Dall_feature_sets%5B_type%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%3Ddf_raw%2C%20%20%23%20df_processed%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20response%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20apply_scaling%3Dscaling_selector.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20penalty%3D%22l2%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20verbose%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%23%20l1-regularized%0A%20%20%20%20%20%20%20%20if%20checkbox_regression_l1.value%20and%20(df_raw%20is%20not%20None)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20regression_metrics_l1%5B_type%5D%20%3D%20solve_any_regression(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20solutions%3Dall_feature_sets%5B_type%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20df%3Ddf_raw%2C%20%20%23%20df_processed%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20response%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20apply_scaling%3Dscaling_selector.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20penalty%3D%22l1%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20verbose%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20if%20save_results%3A%0A%20%20%20%20%20%20%20%20%23%20Save%20candidate%20solutions%0A%20%20%20%20%20%20%20%20msg_features_json%20%3D%20save_feature_lists_json(all_feature_sets%2C%20features_path_json)%0A%20%20%20%20%20%20%20%20msg_features_txt%20%3D%20save_feature_lists_txt(all_feature_sets%2C%20features_path_txt)%0A%0A%20%20%20%20%20%20%20%20%23%20Stack%20all%20the%20outputs%20in%20the%20correct%20order%0A%20%20%20%20%20%20%20%20_displays%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%F0%9F%93%81%20**All%20recovered%20solutions%20saved%20to%3A**%20%60%7Bexperiment_dir%7D%60%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22-%20%7Bmsg_features_txt.split('Candidate%20solutions%20saved%20to%20')%5B1%5D%7D%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22-%20%7Bmsg_features_json.split('Candidate%20solutions%20saved%20to%20')%5B1%5D%7D%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20_displays%20%3D%20%5B%5D%0A%0A%20%20%20%20for%20_type%2C%20_solution%20in%20all_solutions.items()%3A%0A%20%20%20%20%20%20%20%20%23%20Get%20summary%20of%20a%20solution%20type%0A%20%20%20%20%20%20%20%20_displays.append(mo.md(f%22%23%23%23%20Solution%20type%3A%20**%7B_type%7D**%22))%0A%20%20%20%20%20%20%20%20_displays.append(mo.ui.table(solution_summary%5B_type%5D))%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20a%20matrix%20of%20features%20vs.%20components%0A%20%20%20%20%20%20%20%20if%20checkbox_matrix.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_displays.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20get_features_in_components_plot(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20solutions%3Dall_feature_sets%5B_type%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20features_to_show%3Dunique_features_found%5B_type%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20).update_layout(showlegend%3DFalse)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Regression%20or%20classification%3F%0A%20%20%20%20%20%20%20%20task_type%20%3D%20detect_task(y)%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20quick%20validation%20with%20a%20simple%20regression%0A%20%20%20%20%20%20%20%20if%20checkbox_regression_l2.value%20or%20checkbox_regression_l1.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20regression_type%20%3D%20%22logistic%22%20if%20task_type%20%3D%3D%20%22classification%22%20else%20%22linear%22%0A%0A%20%20%20%20%20%20%20%20%23%20l2-regularized%0A%20%20%20%20%20%20%20%20if%20checkbox_regression_l2.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_displays.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%23%23%23%23%20**Quick%20l2-regularized%20%7Bregression_type%7D%20regression%20validation**%20for%20%7B_type%7D%20(testing%20%3D%20training%20data)%3A%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20_displays.append(mo.ui.table(regression_metrics_l2%5B_type%5D))%0A%0A%20%20%20%20%20%20%20%20%23%20l1-regularized%0A%20%20%20%20%20%20%20%20if%20checkbox_regression_l1.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_displays.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%23%23%23%23%20**Quick%20l1-regularized%20%7Bregression_type%7D%20regression%20validation**%20for%20%7B_type%7D%20(testing%20%3D%20training%20data)%3A%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20_displays.append(mo.ui.table(regression_metrics_l1%5B_type%5D))%0A%0A%20%20%20%20%20%20%20%20_displays.append(mo.md(%22%3Cbr%3E%3Cbr%3E%22))%0A%20%20%20%20%20%20%20%20_displays.append(mo.md(%22---%22))%0A%20%20%20%20%20%20%20%20_displays.append(mo.md(%22%3Cbr%3E%3Cbr%3E%22))%0A%0A%20%20%20%20%23%20Return%20all%20displays%20stacked%20vertically%0A%20%20%20%20mo.vstack(_displays)%0A%20%20%20%20return%20all_feature_sets%2C%20all_solutions%2C%20task_type%2C%20unique_features_found%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20**5.%20Modeling%20with%20candidate%20solutions**%20%5Bnon-commercial%20use%20only%5D%0A%0A%20%20%20%20Using%20an%20advanced%20algorithm%20to%20create%20and%20evaluate%20models%20for%20each%20feature%20set%20of%20the%20chosen%20solution%20type.%20Proper%20train-test%20cross-validation%20is%20run.%0A%0A%20%20%20%20**WARNING%3A**%20For%20downstream%20modeling%2C%20we%20use%20TabPFN%2C%20whose%20free%20licence%20can%20be%20used%20only%20for%20research%20purposes.%20%5B(Read%20more.)%5D(https%3A%2F%2Fhuggingface.co%2FPrior-Labs%2Ftabpfn_2_5)%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(all_solutions%2C%20mo)%3A%0A%20%20%20%20%23%20pick%20one%20solution%20type%20for%20further%20evaluation%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20all_solutions%20is%20None%2C%0A%20%20%20%20%20%20%20%20mo.md(%22*Must%20recover%20solutions%20from%20components%20first.%20Click%20button%20above.*%22)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20radio_solutions%20%3D%20mo.ui.radio(%0A%20%20%20%20%20%20%20%20options%3Dall_solutions.keys()%2C%0A%20%20%20%20%20%20%20%20label%3D%22Choose%20one%20solution%20type%3A%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20radio_solutions%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20(radio_solutions%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20radio_solutions)%3A%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20radio_solutions.value%20is%20None%2C%0A%20%20%20%20%20%20%20%20output%3Dmo.md(%22*Cannot%20proceed%20to%20modeling.%20Pick%20a%20solution%20type.*%22)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20The%20big%20RUN%20button%0A%20%20%20%20model_btn%20%3D%20mo.ui.run_button(%0A%20%20%20%20%20%20%20%20label%3D%22Model%20with%20TabPFN%20(non-commercial%20use%20only)%22%2C%20kind%3D%22success%22%0A%20%20%20%20)%0A%20%20%20%20checkbox_shap%20%3D%20mo.ui.checkbox(%0A%20%20%20%20%20%20%20%20value%3DFalse%2C%0A%20%20%20%20%20%20%20%20label%3D%22Compute%20feature%20importances%20in%20the%20model%20(Shapley%20values).%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20checkbox_shap%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20model_btn%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%20checkbox_shap%2C%20model_btn%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20all_feature_sets%2C%0A%20%20%20%20all_solutions%2C%0A%20%20%20%20checkbox_shap%2C%0A%20%20%20%20df_raw%2C%0A%20%20%20%20experiment_dir%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20model_btn%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20radio_solutions%2C%0A%20%20%20%20save_results%2C%0A%20%20%20%20tabpfn_evaluate%2C%0A%20%20%20%20task_type%2C%0A%20%20%20%20unique_features_found%2C%0A%20%20%20%20y%2C%0A)%3A%0A%20%20%20%20mo.stop(%0A%20%20%20%20%20%20%20%20not%20model_btn.value%2C%0A%20%20%20%20%20%20%20%20output%3Dmo.md(%22*Solutions%20prepared.%20Press%20button%20to%20start%20modeling.*%22)%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Get%20the%20selected%20solution%20type%0A%20%20%20%20selected_solution_type%20%3D%20radio_solutions.value%0A%20%20%20%20selected_solution%20%3D%20all_solutions%5Bselected_solution_type%5D%0A%0A%20%20%20%20_eval_displays%20%3D%20%5B%5D%0A%20%20%20%20_eval_displays.append(%0A%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20Evaluating%3A%20**%7Bselected_solution_type%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20-%20Task%20type%3A%20**%7Btask_type%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20-%20Number%20of%20components%3A%20**%7Blen(selected_solution)%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20-%20Computing%20SHAP%20explanations%3A%20**%7B%22Yes%22%20if%20checkbox_shap.value%20else%20%22No%22%7D**%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Get%20features%20for%20each%20component%0A%20%20%20%20component_features%20%3D%20all_feature_sets%5Bselected_solution_type%5D%0A%20%20%20%20component_features%5B%22all_selected_features%22%5D%20%3D%20unique_features_found%5B%0A%20%20%20%20%20%20%20%20selected_solution_type%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20Evaluate%20each%20component%20with%20TabPFN%0A%20%20%20%20tabpfn_results%20%3D%20%7B%7D%0A%20%20%20%20for%20component_name%2C%20feature_list%20in%20component_features.items()%3A%0A%20%20%20%20%20%20%20%20%23%20Get%20the%20feature%20subset%0A%20%20%20%20%20%20%20%20X_component%20%3D%20df_raw%5Bfeature_list%5D%20%20%23%20df_processed%5Bfeature_list%5D%0A%0A%20%20%20%20%20%20%20%20%23%20Run%20TabPFN%20evaluation%0A%20%20%20%20%20%20%20%20tabpfn_results%5Bcomponent_name%5D%20%3D%20tabpfn_evaluate(%0A%20%20%20%20%20%20%20%20%20%20%20%20X_component%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20apply_scaling%3DNone%2C%20%20%23%20Already%20scaled%20during%20preprocessing%0A%20%20%20%20%20%20%20%20%20%20%20%20outer_cv_folds%3D2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tabpfn_kwargs%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20random_state%3D42%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20verbose%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20explain%3D(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20checkbox_shap.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20component_name%20!%3D%20%22all_selected_features%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20shap_sample_size%3D50%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%23%20Show%20average%20scores%20(exclude%20non-scalar%20values)%0A%20%20%20%20all_scores%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20_comp%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20k%3A%20v%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20k%2C%20v%20in%20_result%5B%22average_scores%22%5D.items()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20k%20not%20in%20%5B%22confusion_matrix_sum%22%2C%20%22class_distribution%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20_comp%2C%20_result%20in%20tabpfn_results.items()%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20)%0A%20%20%20%20_eval_displays.append(mo.ui.table(all_scores))%0A%0A%20%20%20%20%23%20Show%20Shapley%20values%20if%20computed%0A%20%20%20%20for%20_comp%2C%20_result%20in%20tabpfn_results.items()%3A%0A%20%20%20%20%20%20%20%20if%20%22shap_explanations%22%20in%20_result%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_eval_displays.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22**Shapley%20values%3A**%20feature%20importances%20in%20the%20model%20from%20%7B_comp%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20_eval_displays.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(pd.DataFrame(_result%5B%22shap_explanations%22%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20_eval_displays.append(mo.md(%22%3Cbr%3E%22))%0A%0A%20%20%20%20%23%20Save%20results%20if%20enabled%0A%20%20%20%20if%20save_results%3A%0A%20%20%20%20%20%20%20%20scores_path%20%3D%20f%22%7Bexperiment_dir%7D%2Ftabpfn_scores_%7Bselected_solution_type.replace('%20'%2C%20'_')%7D.csv%22%0A%20%20%20%20%20%20%20%20all_scores.to_csv(scores_path)%0A%20%20%20%20%20%20%20%20_eval_displays.append(%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%F0%9F%93%8A%20**Results%20saved%20to%3A**%20%60%7Bscores_path.split('%2F')%5B-1%5D%7D%60%3Cbr%3E%3Cbr%3E%22)%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(_eval_displays)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">e61cbe44aa7142b55053c942e32cd787</marimo-code-hash>
</body>
</html>
